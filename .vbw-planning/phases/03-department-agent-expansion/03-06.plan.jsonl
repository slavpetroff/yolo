{"p":"03","n":"06","t":"Test scaffolding for Phase 3 agents and scripts","w":2,"d":["03-01","03-02","03-03","03-04"],"mh":["Tests validate per-dept security agent naming and frontmatter","Tests validate documenter config gate logic","Tests validate critique loop 3-round hard cap","Tests validate critique early exit on high confidence","Tests validate context manifest loading and fallback"],"obj":"Create BATS test scaffolding for all Phase 3 additions: security reviewer agents, documenter agents, critique loop script, documenter gate script, and context manifest system. Tests are in separate plans from implementation per constraints."}
{"id":"T1","tp":"test","a":"Create tests/static/test-dept-security-agent-naming.bats — static naming validation for per-department security agents: (1) yolo-security.md exists with 'Department: Backend' in body; (2) yolo-fe-security.md exists with valid yolo-{dept}-{role}.md naming, has name: yolo-fe-security in frontmatter; (3) yolo-ux-security.md exists with valid naming, has name: yolo-ux-security in frontmatter; (4) All 3 have valid YAML frontmatter with model field; (5) All 3 have disallowedTools including Write and Edit; (6) model-profiles.json contains fe-security and ux-security roles.","f":["tests/static/test-dept-security-agent-naming.bats"],"v":"File exists, contains at least 5 @test blocks, checks agents/yolo-fe-security.md and agents/yolo-ux-security.md","done":false}
{"id":"T2","tp":"test","a":"Create tests/static/test-documenter-agent-naming.bats — static naming validation for documenter agents: (1) yolo-documenter.md exists with name: yolo-documenter in frontmatter; (2) yolo-fe-documenter.md exists with name: yolo-fe-documenter; (3) yolo-ux-documenter.md exists with name: yolo-ux-documenter; (4) All 3 have model: haiku in frontmatter; (5) model-profiles.json contains documenter, fe-documenter, ux-documenter roles; (6) All 3 mention docs.jsonl in output section.","f":["tests/static/test-documenter-agent-naming.bats"],"v":"File exists, contains at least 5 @test blocks, checks all 3 documenter agent files","done":false}
{"id":"T3","tp":"test","a":"Create tests/unit/test-critique-loop.bats — BATS tests for critique-loop.sh: (1) Test 3-round hard cap: mock Critic returning cf=50 for 3 rounds, verify rounds_used=3 and early_exit=false; (2) Test early exit on round 1: mock Critic returning cf=90, verify rounds_used=1 and early_exit=true; (3) Test early exit on round 2: mock Critic returning cf=60 round 1 then cf=88 round 2, verify rounds_used=2 and early_exit=true; (4) Test config reading: verify script reads critique.max_rounds and critique.confidence_threshold from config; (5) Test default values when critique config absent: verify defaults of 3 rounds and 85 threshold.","f":["tests/unit/test-critique-loop.bats"],"v":"File exists, contains at least 4 @test blocks, references critique-loop.sh","done":false}
{"id":"T4","tp":"test","a":"Create tests/unit/test-resolve-documenter-gate.bats — BATS tests for resolve-documenter-gate.sh: (1) Test documenter=always: exits 0 with spawn=true; (2) Test documenter=never: exits 1 with spawn=false; (3) Test documenter=on_request with trigger=on_request: exits 0; (4) Test documenter=on_request with trigger=phase: exits 1; (5) Test missing config key: defaults to on_request behavior.","f":["tests/unit/test-resolve-documenter-gate.bats"],"v":"File exists, contains at least 4 @test blocks, references resolve-documenter-gate.sh","done":false}
{"id":"T5","tp":"test","a":"Create tests/unit/test-context-manifest.bats — BATS tests for context manifest integration in compile-context.sh: (1) Test manifest loading: when context-manifest.json exists, compile-context.sh reads it; (2) Test fallback: when context-manifest.json absent, compile-context.sh uses hardcoded role logic (backward compat); (3) Test new roles: compile-context.sh handles fe-security, ux-security, documenter, fe-documenter, ux-documenter without error; (4) Test budget from manifest: role budget matches manifest value when present; (5) Test measurement: --measure flag reports reduction metrics for manifest-driven compilation.","f":["tests/unit/test-context-manifest.bats"],"v":"File exists, contains at least 4 @test blocks, references context-manifest.json and compile-context.sh","done":false}
