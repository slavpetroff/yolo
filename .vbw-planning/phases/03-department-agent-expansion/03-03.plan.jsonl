{"p":"03","n":"03","t":"Confidence-gated Critique Loop with hard cap","w":1,"d":[],"mh":["critique.jsonl gets cf (confidence) field per round","Critique loop exits early when confidence >= 85 on any round","Critique never exceeds 3 rounds regardless of confidence","critique-loop.sh script enforces cap and threshold","Loop state auditable via round number in critique.jsonl entries"],"obj":"Implement the confidence-gated Critique Loop. Add cf (confidence) field to critique.jsonl schema, create critique-loop.sh to orchestrate multi-round critique with early exit on high confidence. Hard cap of 3 rounds prevents runaway loops. Each round's findings include round number and confidence score for auditability."}
{"id":"T1","tp":"modify","a":"Update agents/yolo-critic.md to support multi-round critique with confidence scoring. Add 'Confidence Scoring' section: after producing findings, Critic self-assesses coverage confidence (0-100) based on: requirements coverage (all REQs examined?), codebase coverage (all modified areas reviewed?), risk surface coverage (known risk patterns checked?). Add cf (confidence) field to output schema: each critique.jsonl entry gets cf:N where N is the round's overall confidence. Add round field 'rd' to each finding: rd:1 for first round, rd:2 for second, etc. Add 'Multi-Round Protocol': Round 1 = standard critique, compute cf. If cf < threshold: Round 2 = targeted re-analysis of low-confidence areas only (gaps in coverage), recompute cf. Round 3 (if needed) = final sweep with forced assumptions documented. Update output schema example to show cf and rd fields. Update Communication schema to include confidence in critique_result.","f":["agents/yolo-critic.md"],"v":"grep -c 'cf' agents/yolo-critic.md returns >= 3; grep -c 'Multi-Round Protocol' agents/yolo-critic.md returns 1; grep -c 'rd' agents/yolo-critic.md returns >= 2","done":false}
{"id":"T2","tp":"create","a":"Create scripts/critique-loop.sh — orchestrates multi-round critique with confidence gating. Takes flags: --phase-dir <path>, --config <path>, --role <critic|fe-critic|ux-critic>. Logic: (1) Read critique.max_rounds from config via jq (default 3); (2) Read critique.confidence_threshold from config via jq (default 85); (3) For round 1 to max_rounds: pass round number to Critic context, collect critique.jsonl output; (4) Parse cf (confidence) from latest round entries via jq; (5) If cf >= threshold: log early exit, output JSON summary, exit 0; (6) After max rounds: force exit with final confidence, output JSON summary; (7) Output: {rounds_used: N, final_confidence: N, early_exit: bool, findings_total: N, findings_per_round: [N,N,N]}. set -euo pipefail. Uses jq for all JSON parsing.","f":["scripts/critique-loop.sh"],"v":"File exists, is executable, contains set -euo pipefail, reads critique.max_rounds via jq, outputs JSON summary with rounds_used field","done":false}
{"id":"T3","tp":"modify","a":"Update references/artifact-formats.md (or the naming-conventions section that documents JSONL keys) to document new critique.jsonl fields: cf (confidence, integer 0-100, per-round confidence score), rd (round, integer 1-3, which critique round produced this finding). Add to critique.jsonl schema section. Note: existing fields (id, cat, sev, q, ctx, sug, st) unchanged. New fields are additive — backward compatible with existing parsers (jq .cf // 0 handles missing field).","f":["references/artifact-formats.md"],"v":"grep -c 'cf' references/artifact-formats.md returns >= 1; grep -c 'rd' references/artifact-formats.md returns >= 1","done":false}
{"id":"T4","tp":"config","a":"Add critique configuration keys to config/defaults.json as a nested 'critique' object: critique.max_rounds (int, default 3), critique.confidence_threshold (int, default 85), critique.enabled (bool, default true). Preserve all existing config structure unchanged. Place after the 'po' object.","f":["config/defaults.json"],"v":"jq '.critique.max_rounds' config/defaults.json returns 3; jq '.critique.confidence_threshold' config/defaults.json returns 85","done":false}
