{"p":"05","n":"01","t":"Integration Gate agent, barrier script, and artifact schema","w":1,"d":[],"mh":{"tr":["Integration Gate agent waits for all active department Testers before proceeding","Barrier script exits non-zero when any department is incomplete","Configurable timeout on barrier convergence","integration-gate-result.jsonl and po_qa_verdict.jsonl schemas defined"],"ar":[],"kl":[]},"obj":"Create the Integration Gate agent (yolo-integration-gate.md) that acts as a barrier convergence point after all department workflows complete. Add integration-gate.sh script for barrier polling with timeout, cross-dept contract checks, and design sync validation. Define all new artifact schemas in artifact-formats.md."}
{"id":"T1","tp":"create","a":"Create agents/yolo-integration-gate.md with frontmatter (name: yolo-integration-gate, tools: Read/Glob/Grep, disallowedTools: Edit/Write/Bash/EnterPlanMode/ExitPlanMode, model: sonnet, maxTurns: 20, permissionMode: plan). Agent checks: (1) API contract consistency — read api-contracts.jsonl, verify all endpoints have status:agreed or status:implemented; (2) Design sync — read design-handoff.jsonl, verify all ready_components are implemented (cross-ref with summary.jsonl fm fields); (3) Cross-dept handoff validation — verify .handoff-*-complete sentinels exist for all active depts; (4) Test results aggregation — read all test-results.jsonl, verify no dept has fl>0. Output: integration-gate-result.jsonl with {r:'PASS'|'FAIL'|'PARTIAL', checks:{api_contracts,design_sync,handoffs,tests}, failures:[], dt}. Read-only agent — returns findings to Lead/Owner. Add Hierarchy, Persona & Voice, Escalation Table, Context sections following yolo-owner.md pattern.","f":["agents/yolo-integration-gate.md"],"v":"test -f agents/yolo-integration-gate.md && grep -c 'integration-gate-result' agents/yolo-integration-gate.md >= 1","done":"Agent file exists with all 4 check types documented, read-only constraint, output schema defined"}
{"id":"T2","tp":"create","a":"Create scripts/integration-gate.sh — barrier convergence script. Usage: integration-gate.sh --phase-dir <dir> --config <config-path> [--timeout <seconds>]. Logic: (1) Read config for active departments (departments.backend/frontend/uiux); (2) For each active dept, check .dept-status-{dept}.json exists with status:complete; (3) If all complete, run cross-dept checks: verify api-contracts.jsonl has no status:proposed (all must be agreed/implemented), verify design-handoff.jsonl deferred list is empty or accepted; (4) If not all complete and timeout not reached, exit 1 (caller polls); (5) If timeout reached, output JSON with per-dept status and which are missing. Output JSON: {gate:'pass'|'fail'|'timeout', departments:{backend:{status,completed_at},frontend:{...},uiux:{...}}, cross_checks:{api_contracts:'pass'|'fail',design_sync:'pass'|'fail'}, timeout_remaining:N}. Use set -euo pipefail, jq for all JSON parsing.","f":["scripts/integration-gate.sh"],"v":"bash scripts/integration-gate.sh --help 2>&1 | grep -q 'phase-dir' || test $? -eq 0","done":"Script exists with barrier polling, cross-dept checks, timeout handling, JSON output"}
{"id":"T3","tp":"create","a":"Create references/integration-gate-protocol.md documenting the Integration Gate workflow. Sections: (1) Overview — barrier convergence point between department completion and PO Q&A; (2) Trigger Conditions — when gate runs (after all dept department_result artifacts exist); (3) Check Matrix — table of checks (API contracts, design sync, handoffs, test results) with pass/fail criteria; (4) Failure Handling — on fail, which dept Lead gets notified with what remediation; (5) Timeout Behavior — default from config integration_gate.timeout_seconds, auto-fail on timeout; (6) Single-Dept Mode — when only backend active, gate checks are simplified (no cross-dept checks, just test results + QA pass). Keep under 150 lines.","f":["references/integration-gate-protocol.md"],"v":"test -f references/integration-gate-protocol.md && wc -l < references/integration-gate-protocol.md | awk '{print ($1 <= 150)}'","done":"Protocol doc exists with all 6 sections, under 150 lines"}
{"id":"T4","tp":"modify","a":"Add two new artifact schemas to references/artifact-formats.md. (A) Add '### Integration Gate Result (integration-gate-result.jsonl)' section after the Security Audit section. Schema Line 1 (summary): r (result PASS|FAIL|PARTIAL), checks (object {api:pass|fail|skip, design:pass|fail|skip, handoffs:pass|fail|skip, tests:pass|fail|skip}), failures (string[]), dt (date). Lines 2+ (per-check detail): check (check name), dept (department), r (result), evidence (string), sug (suggestion). (B) Add '### PO Q&A Verdict (po_qa_verdict.jsonl)' section after integration-gate-result. Schema Line 1: verdict (approve|patch|major), findings_count (number), target_dept (string), confidence (float), dt (date). Lines 2+ (findings): check (string), dept (string), issue (string), sev (critical|major|minor), scope_ref (string). Add both files to Phase Directory Structure listing.","f":["references/artifact-formats.md"],"v":"grep -c 'integration-gate-result' references/artifact-formats.md >= 2 && grep -c 'po_qa_verdict' references/artifact-formats.md >= 2","done":"Both schemas added to artifact-formats.md with key tables, listed in phase directory structure"}
