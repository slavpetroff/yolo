{"p":"05","n":"03","t":"Config extensions for integration gate and rejection routing","w":1,"d":[],"mh":{"tr":["integration_gate config section added to defaults.json","po.default_rejection key defaults to 'patch'","validate-config.sh validates new config keys","Key decisions documented in CLAUDE.md"],"ar":[],"kl":[]},"obj":"Add config keys for integration gate timeout, rejection routing defaults, and delivery mode. Update validate-config.sh to validate new keys. Document key decisions in CLAUDE.md."}
{"id":"T1","tp":"modify","a":"Add integration_gate section to config/defaults.json. Insert after the 'critique' section. New keys: integration_gate.enabled (boolean, default true), integration_gate.timeout_seconds (number, default 600 — 10 min for all depts to complete), integration_gate.checks (object: {api_contracts:true, design_sync:true, handoffs:true, tests:true} — individually toggleable), integration_gate.retry_on_fail (boolean, default true — auto-retry gate after patch fix). Also add po.default_rejection ('patch'|'major', default 'patch') to the existing po section. Also add delivery.mode ('auto'|'manual', default 'auto') and delivery.present_to_user (boolean, default true) as new delivery section.","f":["config/defaults.json"],"v":"jq '.integration_gate.timeout_seconds' config/defaults.json outputs 600; jq '.po.default_rejection' config/defaults.json outputs 'patch'; jq '.delivery.mode' config/defaults.json outputs 'auto'","done":"All 3 config sections added with correct defaults"}
{"id":"T2","tp":"modify","a":"Update scripts/validate-config.sh to validate the new config keys. Add validation rules: (1) integration_gate.enabled must be boolean if present; (2) integration_gate.timeout_seconds must be number 60-3600 if present; (3) integration_gate.checks must be object with boolean values if present; (4) po.default_rejection must be 'patch' or 'major' if present; (5) delivery.mode must be 'auto' or 'manual' if present; (6) delivery.present_to_user must be boolean if present. Follow existing validation pattern in the script (jq-based type checks with error accumulation).","f":["scripts/validate-config.sh"],"v":"echo '{\"integration_gate\":{\"enabled\":true,\"timeout_seconds\":600}}' | jq '.' > /dev/null","done":"All new config keys validated with type checks and range constraints"}
{"id":"T3","tp":"modify","a":"Update the CLAUDE.md Key Decisions table with Phase 5 decisions. Add rows: (1) 'Integration Gate as barrier convergence | 2026-02-18 | Ensures all depts complete before PO Q&A; catches cross-dept contract mismatches early'; (2) 'Patch/Major rejection paths with patch default | 2026-02-18 | Patch is <20% token cost; Major only for vision misalignment'; (3) 'Delivery mode in orchestrator | 2026-02-18 | PO output rendered via AskUserQuestion; user feedback loops back'. Also add integration_gate, po.default_rejection, delivery config keys to the Config description in Active Context.","f":["CLAUDE.md"],"v":"grep -c 'Integration Gate' CLAUDE.md >= 1 && grep -c 'Patch/Major' CLAUDE.md >= 1","done":"3 key decisions added, config keys documented"}
