{"p":"05","n":"05","t":"Context manifest and compile-context extensions for integration gate","w":2,"d":["05-01","05-02"],"mh":{"tr":["integration-gate role added to context-manifest.json","compile-context.sh handles integration-gate role","PO Mode 4 context includes integration-gate-result.jsonl"],"ar":[],"kl":[]},"obj":"Add integration-gate role to config/context-manifest.json with appropriate field filtering. Extend scripts/compile-context.sh to compile context for the integration-gate agent. Update PO context to include integration results for Mode 4."}
{"id":"T1","tp":"modify","a":"Add integration-gate role to config/context-manifest.json. New entry: 'integration-gate': {files: ['REQUIREMENTS.md', 'success_criteria'], artifacts: ['department_result', 'test-results', 'summary'], fields: {summary: ['fm', 'tst'], test-results: ['plan', 'dept', 'phase', 'tc', 'ps', 'fl']}, budget: 3000}. The integration-gate agent needs department results, test metrics, and file lists to validate cross-dept consistency.","f":["config/context-manifest.json"],"v":"jq '.roles[\"integration-gate\"].budget' config/context-manifest.json outputs 3000","done":"integration-gate role added with correct artifacts and field filters"}
{"id":"T2","tp":"modify","a":"Add integration-gate case to scripts/compile-context.sh. Add new case block for BASE_ROLE='integration-gate' (after the 'owner' case). The context should include: (1) emit_header; (2) success_criteria; (3) department results — iterate .dept-status-{dept}.json files; (4) test results summary from test-results.jsonl; (5) API contracts summary from api-contracts.jsonl (if exists); (6) design handoff status from design-handoff.jsonl (if exists); (7) cross-dept handoff sentinels check. Output to .ctx-integration-gate.toon. Follow the existing pattern of other roles — use jq for JSON extraction, reference get_tool_restrictions.","f":["scripts/compile-context.sh"],"v":"grep -c 'integration-gate' scripts/compile-context.sh >= 2","done":"integration-gate case added to compile-context.sh with dept results, test results, cross-dept artifacts"}
{"id":"T3","tp":"modify","a":"Update PO role in config/context-manifest.json to include integration-gate-result artifact for Mode 4. Add 'po' role if not present, or modify existing: add 'integration-gate-result' to artifacts array, add field filter for integration-gate-result: ['r', 'checks', 'failures']. Also add 'department_result' to PO artifacts since Mode 4 needs dept results. This ensures compile-context.sh provides PO with the right context for post-integration Q&A.","f":["config/context-manifest.json"],"v":"jq '.roles.po.artifacts | index(\"integration-gate-result\")' config/context-manifest.json returns non-null","done":"PO role updated with integration-gate-result and department_result artifacts"}
{"id":"T4","tp":"modify","a":"Add .ctx-integration-gate.toon to the Phase Directory Structure in references/artifact-formats.md. Insert in the compiled context section (after .ctx-owner.toon). Also add integration-gate-result.jsonl to the committed artifacts list if not already present from 05-01/T4. Verify the Multi-Department Phase Directory section also includes the new compiled context file.","f":["references/artifact-formats.md"],"v":"grep -c 'ctx-integration-gate' references/artifact-formats.md >= 1","done":"Context file and artifact listed in phase directory structure"}
