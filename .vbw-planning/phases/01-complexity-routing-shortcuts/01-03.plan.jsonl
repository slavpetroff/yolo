{"p":"01","n":"03","t":"Add complexity routing config and defaults","w":1,"d":[],"mh":["Config settings for complexity thresholds","Backward compatible defaults","Complexity routing can be disabled"],"obj":"Add configuration entries for complexity routing thresholds, path selection, and feature toggle to config/defaults.json and related validation."}
{"id":"T1","tp":"feat","a":"Add complexity routing config section to config/defaults.json. New top-level key 'complexity_routing' with sub-keys: enabled (boolean, default true), trivial_confidence_threshold (float, default 0.85 — minimum confidence to route as trivial), medium_confidence_threshold (float, default 0.7 — minimum confidence to route as medium), fallback_path (string, default 'high' — path when confidence below medium threshold), force_analyze_model (string, default 'opus' — model override for analyze agent, always opus), max_trivial_files (int, default 3 — max files touched for trivial classification), max_medium_tasks (int, default 3 — max tasks for medium plan). Preserve all existing config keys unchanged.","f":["config/defaults.json"],"v":"jq '.complexity_routing.enabled' config/defaults.json returns true; jq '.complexity_routing | keys' returns all 6 sub-keys","done":false}
{"id":"T2","tp":"feat","a":"Update scripts/phase-detect.sh to output complexity_routing config values. After the existing config reads (around line 170), add a new section that reads complexity_routing from config.json: config_complexity_routing (true/false), config_trivial_threshold (float), config_medium_threshold (float), config_fallback_path (string). Use the same jq batch-read pattern as existing config reads. Add defaults matching config/defaults.json values when key is missing.","f":["scripts/phase-detect.sh"],"v":"bash scripts/phase-detect.sh 2>/dev/null | grep config_complexity_routing returns a value","done":false}
{"id":"T3","tp":"feat","a":"Update scripts/validate-config.sh to validate the new complexity_routing section. Add validation rules: enabled must be boolean, trivial_confidence_threshold must be float 0.0-1.0, medium_confidence_threshold must be float 0.0-1.0, trivial threshold must be > medium threshold, fallback_path must be one of trivial|medium|high, force_analyze_model must be one of opus|sonnet|haiku, max_trivial_files must be positive integer, max_medium_tasks must be positive integer. Graceful handling: if complexity_routing key is missing entirely, skip validation (backward compatible with old configs).","f":["scripts/validate-config.sh"],"v":"echo '{\"complexity_routing\":{\"enabled\":true,\"trivial_confidence_threshold\":0.85,\"medium_confidence_threshold\":0.7,\"fallback_path\":\"high\",\"force_analyze_model\":\"opus\",\"max_trivial_files\":3,\"max_medium_tasks\":3}}' | jq . > /tmp/test-config.json && bash scripts/validate-config.sh /tmp/test-config.json exits 0","done":false}
