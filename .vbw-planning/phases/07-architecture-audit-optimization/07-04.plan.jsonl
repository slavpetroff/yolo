{"p":"07","n":"04","t":"Rolling summaries and error recovery context in compile-context","w":1,"d":[],"mh":{"tr":["compile-context.sh uses summary.jsonl for earlier plans instead of full artifacts","error recovery context injected into Dev/Senior context on retry","context growth capped regardless of phase plan count"],"ar":["full artifacts still available for current plan"],"kl":["summary.jsonl already exists for completed plans","error context from gaps.jsonl already partially used"]},"obj":"Implement T-1 (rolling summary approach) in compile-context.sh to cap context growth for later plans in a phase, and CG-4 (error recovery context) to inject prior failure context into retry agent prompts."}
{"id":"T1","tp":"modify","a":"Update compile-context.sh dev case block to include only summary.jsonl (not full plan.jsonl) for plans earlier than the current PLAN_PATH. For the current plan, include full plan.jsonl as before. Use PLAN_PATH to determine which plan is current by extracting NN-MM from filename.","f":["scripts/compile-context.sh"],"v":"With 3 plans in a phase, compiling context for plan 03 includes summaries for 01/02 but full plan for 03","done":"Dev context uses rolling summaries for completed plans, full detail for current plan only"}
{"id":"T2","tp":"modify","a":"Update compile-context.sh senior case block with same rolling summary pattern as T1. Senior reviews code for current plan but only needs summary-level context from prior plans.","f":["scripts/compile-context.sh"],"v":"Senior context for plan 03 includes summaries for 01/02 and full architecture + current plan details","done":"Senior context uses rolling summaries for completed plans"}
{"id":"T3","tp":"modify","a":"Update compile-context.sh qa and qa-code case blocks to include rolling summaries for all plans (QA reviews phase-wide but doesnt need full plan detail). Include test-results.jsonl as primary QA input.","f":["scripts/compile-context.sh"],"v":"QA context includes summary data and test-results, not full plan.jsonl for every plan","done":"QA context uses summaries instead of full plan artifacts"}
{"id":"T4","tp":"modify","a":"Add error recovery context to compile-context.sh dev and senior case blocks. When gaps.jsonl has entries with st:open and a retry_context field, include the error message and prior attempt summary in the agent context under an error_recovery section.","f":["scripts/compile-context.sh"],"v":"When gaps.jsonl has retry_context entries, dev context includes error_recovery section","done":"Dev/Senior context on retry includes prior failure details from gaps.jsonl"}
{"id":"T5","tp":"create","a":"Add BATS tests for rolling summary behavior: test that plan 03 context includes summaries for 01/02 but full plan for 03; test error recovery context injection.","f":["tests/unit/compile-context-rolling-summary.bats"],"v":"bats tests/unit/compile-context-rolling-summary.bats passes","done":"Tests verify rolling summary and error recovery context behavior"}
