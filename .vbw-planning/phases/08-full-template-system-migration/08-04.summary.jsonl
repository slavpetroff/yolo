{"p":"08","n":"04","t":"Regenerate script and GENERATED marker","s":"complete","tasks":5,"commits":5}
{"id":"T1","s":"complete","fm":"Added GENERATED marker ('<!-- GENERATED by generate-agent.sh -- DO NOT EDIT MANUALLY -->') as first line of all generate-agent.sh output. Marker prepended after placeholder substitution and mode filtering. Appears in both --dry-run and file output."}
{"id":"T2","s":"complete","fm":"Created scripts/regenerate-agents.sh. Iterates 9 roles x 3 depts = 27 combinations, calls generate-agent.sh for each, reports success/failure per combo, exits 0 only if all 27 succeed. Uses set -euo pipefail. Includes --help flag."}
{"id":"T3","s":"complete","fm":"Added --check flag to regenerate-agents.sh. In check mode, runs generate-agent.sh --dry-run for each combo and diffs against current agent file. Prints diffs for stale files. Exits 1 if any differ, 0 if all match."}
{"id":"T4","s":"complete","fm":"Added --force and --dry-run flags. --force overwrites without prompting, --dry-run passes through to generate-agent.sh. Interactive prompt when neither flag set. Summary reports updated/unchanged counts. Fixed empty array expansion with set -u via ${arr[@]+\"${arr[@]}\"} pattern."}
{"id":"T5","s":"complete","fm":"Added .agent-generation-hash support. compute_source_hash() concatenates all templates + overlays and sha256 hashes. Hash written to agents/.agent-generation-hash after successful regeneration (skipped on --dry-run or failures). --check verifies stored hash matches current source inputs."}
