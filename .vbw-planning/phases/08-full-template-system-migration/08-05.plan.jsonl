{"p":"08","n":"05","t":"Wire generation into go.md and hooks","w":2,"d":["08-01","08-02","08-03","08-04"],"mh":{"tr":["SubagentStart hook triggers generate-agent.sh for department agents before spawn","go.md passes --mode flag when spawning agents based on workflow step","staleness detection warns on SessionStart when templates/overlays changed"],"ar":["hooks/hooks.json updated with template generation SubagentStart hook","scripts/template-generate-hook.sh for SubagentStart integration","scripts/template-staleness-check.sh for SessionStart integration","commands/go.md updated with --mode flag per workflow step"],"kl":["SubagentStart hook calls template-generate-hook.sh which calls generate-agent.sh","SessionStart hook calls template-staleness-check.sh which reads agents/.agent-generation-hash","go.md step-to-mode mapping: step 3 (plan)->plan, step 5-7 (implement)->implement, step 4,8 (review)->review, step 9 (qa)->qa, step 5 (test)->test"]},"obj":"Wire generate-agent.sh into the live system: add SubagentStart hook for on-demand generation, add SessionStart staleness detection, and update go.md to pass --mode flag when spawning department agents for per-step token savings."}
{"id":"T1","tp":"feat","a":"Create scripts/template-generate-hook.sh for SubagentStart integration. The script should: (1) parse the agent name from hook input, (2) check if it's a department agent (matches pattern yolo-{fe-|ux-|}{role}), (3) extract role and dept from the name, (4) call generate-agent.sh --role --dept to regenerate the agent file before spawn, (5) exit 0 always (graceful degradation). Skip non-department agents (owner, critic, scout, etc.).","f":["scripts/template-generate-hook.sh"],"v":"script handles all 27 dept agent names correctly; skips non-dept agents; exits 0 on error","done":false}
{"id":"T2","tp":"feat","a":"Add SubagentStart hook entry to hooks/hooks.json that triggers template-generate-hook.sh for department agents. Use matcher pattern matching dept agent names. Wire through hook-wrapper.sh per existing pattern. Place BEFORE the existing agent-start.sh hook so generation happens first.","f":["hooks/hooks.json"],"v":"hooks.json is valid JSON; new hook entry exists in SubagentStart array before agent-start.sh","done":false}
{"id":"T3","tp":"feat","a":"Create scripts/template-staleness-check.sh for SessionStart integration. The script should: (1) read agents/.agent-generation-hash, (2) compute current hash of templates + overlays, (3) compare, (4) if different, emit a warning message to stdout for Claude Code to display. Exit 0 always.","f":["scripts/template-staleness-check.sh"],"v":"script warns when hash mismatches; stays silent when hashes match; exits 0 always","done":false}
{"id":"T4","tp":"feat","a":"Add SessionStart hook entry to hooks/hooks.json for template-staleness-check.sh. Wire through hook-wrapper.sh per existing pattern. Place after existing SessionStart hooks.","f":["hooks/hooks.json"],"v":"hooks.json is valid JSON; new SessionStart hook entry exists","done":false}
{"id":"T5","tp":"feat","a":"Update commands/go.md to pass --mode flag when spawning department agents. Map workflow steps to modes: Design Review (step 4) -> review, Test Authoring (step 5) -> test, Implementation (step 6-7) -> implement, Code Review (step 8) -> review, QA (step 9) -> qa, Planning (step 3) -> plan. Update the agent spawn commands to include mode context that template-generate-hook.sh can read. The hook should detect mode from CLAUDE_TOOL_INPUT or an env var set by go.md.","f":["commands/go.md","scripts/template-generate-hook.sh"],"v":"go.md spawn commands include mode information; template-generate-hook.sh reads and passes --mode to generate-agent.sh","done":false}
