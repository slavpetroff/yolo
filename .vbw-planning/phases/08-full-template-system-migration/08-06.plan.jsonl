{"p":"08","n":"06","t":"BATS tests for template generation pipeline","w":2,"d":["08-01","08-02","08-03","08-04"],"mh":{"tr":["BATS tests cover all 27 role+dept combinations","tests verify no unreplaced placeholders in any generated output","tests verify generated output matches regenerated output (no stale drift)","tests verify GENERATED marker presence"],"ar":["tests/unit/generate-agent-all-combos.bats covering all 27 combos","tests/unit/regenerate-agents.bats covering regeneration wrapper and staleness"],"kl":["tests use generate-agent.sh --dry-run for non-destructive verification","tests use regenerate-agents.sh --check for staleness detection"]},"obj":"Add comprehensive BATS test suite covering all 27 agent generation combinations, GENERATED marker verification, staleness detection via --check, and regeneration pipeline integrity."}
{"id":"T1","tp":"test","a":"Create tests/unit/generate-agent-all-combos.bats. Test all 27 role+dept combinations: for each of 9 roles x 3 depts, verify generate-agent.sh --dry-run (1) exits 0, (2) produces non-empty output, (3) contains no unreplaced {{PLACEHOLDER}} patterns, (4) contains expected YAML frontmatter, (5) contains expected H1 heading.","f":["tests/unit/generate-agent-all-combos.bats"],"v":"bats tests/unit/generate-agent-all-combos.bats passes all tests","done":false}
{"id":"T2","tp":"test","a":"Add tests to generate-agent-all-combos.bats: for each of the 27 combos, verify (1) GENERATED marker is present as first non-frontmatter line, (2) output contains role-appropriate sections (e.g., dev has Execution Protocol, qa has Verification Protocol), (3) placeholder values from overlay are actually substituted (e.g., DEPT_PREFIX replaced, not literal).","f":["tests/unit/generate-agent-all-combos.bats"],"v":"extended tests pass for all 27 combos","done":false}
{"id":"T3","tp":"test","a":"Create tests/unit/regenerate-agents.bats. Test regenerate-agents.sh: (1) --help exits 0, (2) --dry-run produces output for all 27 combos without writing files, (3) --check exits 0 after a fresh regeneration, (4) --check exits 1 after manually modifying an agent file.","f":["tests/unit/regenerate-agents.bats"],"v":"bats tests/unit/regenerate-agents.bats passes all tests","done":false}
{"id":"T4","tp":"test","a":"Add staleness tests to regenerate-agents.bats: (1) verify agents/.agent-generation-hash is created after regeneration, (2) verify hash changes when template content changes, (3) verify hash changes when overlay content changes, (4) verify --check detects stale hash.","f":["tests/unit/regenerate-agents.bats"],"v":"staleness tests pass","done":false}
{"id":"T5","tp":"test","a":"Add hook integration tests: create tests/unit/template-hooks.bats. Test (1) template-generate-hook.sh correctly identifies dept agents vs non-dept agents, (2) template-generate-hook.sh exits 0 for non-dept agents without generating, (3) template-staleness-check.sh exits 0 when hash matches, (4) template-staleness-check.sh emits warning when hash mismatches.","f":["tests/unit/template-hooks.bats"],"v":"bats tests/unit/template-hooks.bats passes all tests","done":false}
