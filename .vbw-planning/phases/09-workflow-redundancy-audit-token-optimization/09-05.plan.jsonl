{"phase":"09","plan":"09-05","title":"Consolidate QA gate scripts into single qa-gate.sh with --tier","wave":1,"depends_on":[],"must_haves":["scripts/qa-gate.sh --tier task|plan|phase replaces 4 scripts","Shared timeout/lock logic extracted","All existing QA gate tests pass"]}
{"id":"T1","title":"Refactor qa-gate.sh into consolidated dispatcher with --tier","file":"scripts/qa-gate.sh","action":"modify","desc":"Rewrite the existing qa-gate.sh (currently a lightweight notification hook) into a full consolidated QA gate dispatcher. Accept --tier task|plan|phase to dispatch to internal functions gate_post_task(), gate_post_plan(), gate_post_phase(). Extract shared logic from all 3 post-* scripts: run_with_timeout(), has_flock(), acquire_lock_flock(), acquire_lock_mkdir(). Source lib/yolo-common.sh for shared functions if available. Keep --phase-dir, --plan, --task, --timeout, --scope, --files flags."}
{"id":"T2","title":"Migrate qa-gate-post-task.sh logic into qa-gate.sh gate_post_task()","file":"scripts/qa-gate.sh","action":"modify","desc":"Move the full post-task logic from qa-gate-post-task.sh into gate_post_task() function. Includes: test-summary.sh invocation, result file locking, JSON result generation, fail-open behavior. Preserve all exit codes and output formats exactly."}
{"id":"T3","title":"Migrate qa-gate-post-plan.sh and qa-gate-post-phase.sh logic","file":"scripts/qa-gate.sh","action":"modify","desc":"Move qa-gate-post-plan.sh logic into gate_post_plan() and qa-gate-post-phase.sh logic into gate_post_phase(). Post-plan: summary verification, full test suite, must_have coverage checks. Post-phase: validate-gates for all steps, all plans complete check, full test suite. Preserve all existing behavior."}
{"id":"T4","title":"Update qa-gate-integration.md for consolidated qa-gate.sh","file":"references/qa-gate-integration.md","action":"modify","desc":"Update qa-gate-integration.md to document the new consolidated qa-gate.sh --tier task|plan|phase interface. Replace all references to qa-gate-post-task.sh, qa-gate-post-plan.sh, qa-gate-post-phase.sh. Update usage examples and JSON output documentation. Note: go.md and execute-protocol.md references will be updated in plan 09-06 and 09-10 (wave 2/3)."}
{"id":"T5","title":"Delete deprecated qa-gate-post-task.sh, qa-gate-post-plan.sh, qa-gate-post-phase.sh","file":"scripts/qa-gate-post-task.sh","action":"delete","desc":"Delete scripts/qa-gate-post-task.sh, scripts/qa-gate-post-plan.sh, scripts/qa-gate-post-phase.sh after all logic migrated to qa-gate.sh. Verify with grep that the only remaining references are in go.md and execute-protocol.md (which will be updated in wave 2/3 plans)."}
