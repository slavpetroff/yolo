phase: 03
goal: Align agent hierarchy with real company processes â€” add missing protocols, review ownership language, and cross-team communication patterns

tasks[4]{id,action,files,done,spec}:
  T1,Audit all 26 agent prompts for missing real-company patterns (REQ-05): review cycles, ownership language, status reporting, handoff protocols, change management. Produce audit-report.jsonl with one finding per gap.,.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl,audit-report.jsonl committed with all identified gaps,## T1: Audit 26 Agent Prompts for Missing Patterns

### Context (D1, D2, C1, C4)
Phase 3 aligns the 26-agent hierarchy with real company processes. This task audits all agent prompt files to identify missing patterns.

### Files to Read
Read all 26 agent files from `agents/` directory:
- Backend (7): yolo-architect.md, yolo-lead.md, yolo-senior.md, yolo-dev.md, yolo-qa.md, yolo-qa-code.md, yolo-tester.md
- Frontend (7): yolo-fe-architect.md, yolo-fe-lead.md, yolo-fe-senior.md, yolo-fe-dev.md, yolo-fe-qa.md, yolo-fe-qa-code.md, yolo-fe-tester.md
- UX (7): yolo-ux-architect.md, yolo-ux-lead.md, yolo-ux-senior.md, yolo-ux-dev.md, yolo-ux-qa.md, yolo-ux-qa-code.md, yolo-ux-tester.md
- Shared (5): yolo-owner.md, yolo-critic.md, yolo-scout.md, yolo-debugger.md, yolo-security.md

### Audit Categories
For each agent, check for presence of these patterns:
1. **Review Ownership Language**: Does this agent (if a reviewer per D1) have explicit ownership language for subordinate output? Per D1, only 16 reviewing agents need this: Senior, Lead, Architect, Owner, QA, QA-Code across all 3 depts. Non-reviewing agents (Dev, Tester, Scout, Critic, Debugger, Security) are excluded.
2. **Status Reporting**: Does the agent document when/how to report progress? (Leads need this per D5.)
3. **Handoff Protocol**: Does the agent reference formal handoff between pipeline stages? (Architect->Lead per D3.)
4. **Change Management**: Does the agent document revision cycles, Minor/Major classification? (Senior + Dev per D4.)
5. **Review Cycles**: Does Senior document max cycles and escalation?

### Output File
Create `.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl`.
Each line is a JSON object with these fields:
```json
{"id":"AG-001","area":"agent-prompts","agent":"yolo-senior.md","gap":"Missing Review Ownership Language section","severity":"major","req":"REQ-06","cat":"review-ownership"}
```

Field definitions:
- `id`: Sequential ID with AG- prefix (AG-001, AG-002, etc.)
- `area`: Always `agent-prompts` for this task
- `agent`: The agent filename (e.g., `yolo-senior.md`)
- `gap`: Description of missing pattern
- `severity`: `critical` (blocks workflow), `major` (missing required pattern), `minor` (improvement)
- `req`: REQ-05 or REQ-06
- `cat`: Category from audit categories above (review-ownership, status-reporting, handoff-protocol, change-management, review-cycles)

### Expected Findings
Expect to identify:
- 16 agents missing `## Review Ownership` section (all reviewing agents per D1)
- 3 Lead agents missing status reporting instructions
- Missing Architect->Lead handoff formalization
- Senior + Dev missing change management formalization

### Verification
- Run: `jq empty .yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl` (must succeed)
- Run: `jq -r .id .yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl | wc -l` (must be > 0)
- Every line must have all 7 fields (id, area, agent, gap, severity, req, cat)

### Commit
`docs(03-company-org-alignment-review-patterns): agent prompt audit report`
  T2,Audit the 11-step workflow in execute-protocol.md for missing real-company processes (REQ-05): R&D handoff formalization, change management between steps, inter-step status reporting, QA feedback loops. Append findings to audit-report.jsonl.,.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl,Workflow audit findings appended to audit-report.jsonl,## T2: Audit 11-Step Workflow for Missing Processes

### Context (D2, D3, D4, D5, C4, C5, C7)
The 11-step workflow in execute-protocol.md needs auditing for gaps vs real company engineering processes.

### Files to Read
1. `references/execute-protocol.md` -- the full 11-step workflow
2. `references/company-hierarchy.md` -- hierarchy, escalation, code review chain
3. `references/cross-team-protocol.md` -- cross-dept communication
4. `references/multi-dept-protocol.md` -- multi-dept orchestration

### Audit Checks
For each of the 11 steps, check:
1. **R&D Handoff (Steps 1-3)**: Is the Critic->Scout->Architect pipeline formalized as a protocol doc? Currently no standalone handoff protocol exists (per D3, it will be created in 03-03).
2. **Architect->Lead Handoff (Step 3->4)**: Is there a completeness checklist for architecture.toon before Lead can plan? Currently just a file existence check. Per D3, a stage-gate model is needed.
3. **Change Management (Step 7->8)**: Is the Senior->Dev revision cycle documented with Minor/Major classification? Currently only '2 cycles max' stated in Senior prompt. Per D4, formalization needed.
4. **Status Reporting**: Is there inter-step progress reporting from Leads? Per D5, missing.
5. **QA Feedback Loops (Step 9)**: Are QA remediation cycles documented with clear escalation paths? (Already exists in execute-protocol.md but cross-reference to company-hierarchy.md may be incomplete.)
6. **Stale References**: Per D2, check for '10-step' references that should be '11-step'. Note: Do NOT fix these now -- just document them as findings.

### Output
Append to existing `.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl`.
Use ID prefix `WF-` (WF-001, WF-002, etc.) and `area: "workflow"`.

Example entry:
```json
{"id":"WF-001","area":"workflow","agent":"execute-protocol.md","gap":"No formalized R&D handoff protocol between Critic-Scout-Architect","severity":"major","req":"REQ-05","cat":"handoff-protocol"}
```

Also document each stale 10-step reference as a finding:
```json
{"id":"WF-010","area":"workflow","agent":"agents/yolo-lead.md:14","gap":"Stale 10-step reference (should be 11-step)","severity":"major","req":"REQ-05","cat":"stale-reference"}
```

### Expected Findings
- 19 stale 10-step references across 12 files (per D2 grep sweep)
- Missing R&D handoff protocol doc
- Missing Architect->Lead stage-gate
- Missing change management formalization
- Missing status reporting protocol

### Verification
- `jq empty .yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl` succeeds
- `jq -r 'select(.area=="workflow") | .id' .yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl | wc -l` returns > 0
- Every new line has all 7 required fields

### Commit
`docs(03-company-org-alignment-review-patterns): workflow audit findings`
  T3,Audit escalation chains and cross-team communication in company-hierarchy.md and cross-team-protocol.md for gaps vs real company (REQ-05): missing feedback loops, incomplete escalation context, status reporting gaps. Append findings to audit-report.jsonl.,.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl,Escalation and communication audit findings appended,## T3: Audit Escalation Chains and Cross-Team Communication

### Context (D3, D5, C5, C10)
Audit the escalation and communication patterns for gaps vs real company processes.

### Files to Read
1. `references/company-hierarchy.md` -- escalation chain, decision authority matrix, code review chain
2. `references/cross-team-protocol.md` -- dept execution order, communication rules, handoff gates
3. `references/multi-dept-protocol.md` -- multi-dept dispatch, coordination files
4. `references/handoff-schemas.md` -- all handoff message schemas

### Audit Checks
1. **Escalation Context**: Does each agent's escalation include evidence requirements? (company-hierarchy.md has 'Escalation includes evidence' rule but some agents may not reference it.)
2. **Feedback Loops**: Is there a documented feedback path from QA back to Senior/Dev? (QA Remediation Chain exists but may lack detail on feedback content.)
3. **Cross-Dept Communication Completeness**: Are all communication paths in cross-team-protocol.md complete? Check the Team Mode Transport Differences table for coverage.
4. **Status Reporting Gap**: Per D5, cross-team status reporting protocol is missing from cross-team-protocol.md. Document this as a gap.
5. **Owner Feedback Loop**: Does Owner have a documented path to push corrected context back down? (company-hierarchy.md mentions 'Escalation Restores Context' but needs stronger formalization.)
6. **Handoff Schema Completeness**: Are all required handoff schemas defined? Check for missing phase_progress or status_report schema.

### Output
Append to existing `.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl`.
Use ID prefix `EC-` (EC-001, EC-002, etc.) and `area: "escalation-communication"`.

Example entry:
```json
{"id":"EC-001","area":"escalation-communication","agent":"cross-team-protocol.md","gap":"No cross-team status reporting section","severity":"minor","req":"REQ-05","cat":"status-reporting"}
```

### Expected Findings
- Missing status reporting section in cross-team-protocol.md
- Missing phase_progress schema in handoff-schemas.md
- Potentially incomplete feedback loop documentation

### Verification
- `jq empty .yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl` succeeds
- `jq -r 'select(.area=="escalation-communication") | .id' .yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl | wc -l` returns > 0

### Commit
`docs(03-company-org-alignment-review-patterns): escalation and communication audit`
  T4,Create references/audit-checklist.md -- a reusable checklist comparing YOLO hierarchy against real company processes (REQ-05). Sections: Agent Roles (26 agents x role alignment), Workflow Steps (11 steps x process alignment), Escalation Paths, Communication Patterns, Review Cycles, Change Management. Derive from audit-report.jsonl findings.,references/audit-checklist.md,Reusable audit checklist committed to references/,## T4: Create Reusable Audit Checklist

### Context (D1-D7, C1-C10)
Consolidate all findings from T1-T3 audit-report.jsonl into a reusable checklist document that can be run after any future phase to verify alignment.

### File to Create
`references/audit-checklist.md`

### Structure
The file must have exactly these sections with Markdown headers:

```markdown
# YOLO Company Alignment Audit Checklist

Reusable checklist comparing YOLO agent hierarchy against real company engineering processes. Run after each phase to verify alignment.

## Agent Roles (26 agents)

| # | Agent | Role Alignment | Review Owner | Status Reporting | Handoff | Change Mgmt |
|---|-------|---------------|-------------|-----------------|---------|-------------|
| 1 | yolo-architect | ... | Required (per D1) | N/A | Required | N/A |
...(all 26 agents)

Checklist:
- [ ] All 16 reviewing agents have ## Review Ownership section
- [ ] All 3 Lead agents have status reporting instructions
- [ ] Architect references R&D handoff protocol
- [ ] Senior references change management loops
- [ ] Dev references collaborative revision process

## Workflow Steps (11 steps)

| Step | Name | Agent | Handoff In | Handoff Out | Gate | Status |
|------|------|-------|-----------|-------------|------|--------|
| 1 | Critique | Critic | Phase dir | critique.jsonl | Entry: dir exists | |
...(all 11 steps)

Checklist:
- [ ] Zero stale 10-step references across codebase
- [ ] R&D handoff protocol exists (references/rnd-handoff-protocol.md)
- [ ] Architect->Lead stage-gate documented
- [ ] Change management section in execute-protocol.md
- [ ] Status reporting protocol referenced

## Escalation Paths

| Chain | Path | Evidence Req | Feedback Loop |
|-------|------|-------------|---------------|
| Single-dept | Dev > Senior > Lead > Architect > User | Yes | Resolution flows down as artifacts |
| Multi-dept | Dept Dev > ... > Owner > User | Yes | Owner pushes corrected context down |

Checklist:
- [ ] Every agent documents exact escalation target
- [ ] Escalation includes evidence requirement
- [ ] Feedback loop documented for each escalation path

## Communication Patterns

Checklist:
- [ ] Cross-dept communication goes through Leads only
- [ ] All cross-dept data passes through handoff artifacts
- [ ] Backend-UI/UX isolation absolute
- [ ] Status reporting protocol in cross-team-protocol.md
- [ ] All handoff schemas in handoff-schemas.md

## Review Cycles

Checklist:
- [ ] Senior: 2-cycle max documented with escalation
- [ ] Minor/Major classification documented
- [ ] QA remediation chain (3-level) documented
- [ ] Metric collection hooks defined for Phase 4

## Change Management

Checklist:
- [ ] Senior-Dev revision cycle collaborative (not gatekeeping)
- [ ] Minor changes auto-approve after cycle 1 if nits only
- [ ] Major changes escalate after cycle 2
- [ ] Phase 4 extensibility hooks at metric collection points
```

### Content Derivation
Read `.yolo-planning/phases/03-company-org-alignment-review-patterns/audit-report.jsonl` to populate the Status columns. For each checklist item, if the audit-report has a corresponding gap finding, mark it as `[ ]` (unchecked). The checklist serves as the target state -- Phase 3 plans will check off these items.

### Verification
- File exists: `[ -f references/audit-checklist.md ]`
- Contains all required sections: `grep -c '## Agent Roles' references/audit-checklist.md` returns 1, repeat for 'Workflow Steps', 'Escalation Paths', 'Communication Patterns', 'Review Cycles', 'Change Management'
- Contains all 26 agents in the table: `grep -c 'yolo-' references/audit-checklist.md` returns >= 26

### Commit
`docs(03-company-org-alignment-review-patterns): reusable audit checklist`

conventions[15]{category,rule}:

dept_conventions:

skills:

reference_package: @references/packages/dev.toon
tool_restrictions:
