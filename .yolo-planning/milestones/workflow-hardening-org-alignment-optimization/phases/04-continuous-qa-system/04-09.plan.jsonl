{"p":"04","n":"09","t":"QA agent prompt updates for continuous operation","w":2,"d":["04-06","04-07"],"mh":{"tr":["yolo-qa.md includes continuous QA section describing post-task and post-plan gate awareness","yolo-qa-code.md includes post-task gate result consumption for incremental verification","Both agents understand gate result JSON schema and can reference prior gate results","QA agents operate at plan-level (existing) AND can be invoked per-task batch (new)"],"ar":[{"p":"agents/yolo-qa.md","pv":"file exists","c":"Contains Continuous QA section with gate-aware verification protocol"},{"p":"agents/yolo-qa-code.md","pv":"file exists","c":"Contains gate result consumption section for incremental verification"}],"kl":[{"fr":"agents/yolo-qa.md continuous QA section","to":"scripts/qa-gate-post-plan.sh","vi":"QA Lead references post-plan gate results in verification protocol"},{"fr":"agents/yolo-qa-code.md gate consumption","to":"scripts/qa-gate-post-task.sh","vi":"QA Code reads post-task gate results for incremental assessment"},{"fr":"agents/yolo-qa.md","to":"references/qa-gate-integration.md","vi":"QA agent references integration doc for gate trigger points"}]},"obj":"Update QA agent prompts (yolo-qa.md, yolo-qa-code.md) to understand continuous QA gate results and operate in both batch and incremental modes","sk":["commit"],"fm":["agents/yolo-qa.md","agents/yolo-qa-code.md"]}
{"id":"T1","tp":"auto","a":"Add Continuous QA section to agents/yolo-qa.md: (1) Gate-aware verification -- QA Lead receives post-plan gate results as input and factors them into verification tier assessment, (2) Incremental mode -- when invoked after a task batch rather than at phase end, QA Lead scopes verification to the completed tasks only, (3) Gate result JSON schema reference, (4) Escalation on gate failure (QA Lead confirms or overrides gate FAIL). REQ-07 QA agent update.","f":["agents/yolo-qa.md"],"v":"Continuous QA section exists with gate-aware protocol and incremental mode","done":"QA Lead continuous mode committed","spec":"File: agents/yolo-qa.md (modify). Location: Insert new section '## Continuous QA (Gate-Aware Verification)' AFTER the existing '## Escalation Table' section (after line 56) and BEFORE '## Teammate API'. Content: (1) Opening paragraph: 'When invoked at Step 9, QA Lead has access to prior gate results from the continuous QA system. Gate results are stored in {phase-dir}/.qa-gate-results.jsonl (one JSONL line per gate invocation). Use these to accelerate and focus verification.' (2) Subsection '### Gate Result Consumption': 'Read .qa-gate-results.jsonl from phase directory. Filter by gl (gate_level) field: gl=post-plan entries contain plan-level gate results. For each plan, check the most recent post-plan gate result: if r=PASS, plan passed automated checks (summary exists, tests pass, must_haves verified). If r=FAIL, plan has known failures -- focus verification on failure areas from tst and mh fields.' (3) Subsection '### Incremental Mode': 'When QA Lead is invoked mid-phase (after a task batch, not at phase end), scope verification to completed plans only. Check .qa-gate-results.jsonl for which plans have post-plan results. Only verify plans with gate results. Plans without gate results are still in-progress -- skip them.' (4) Subsection '### Gate Override Protocol': 'QA Lead may confirm or override a gate FAIL. If gate result is r=FAIL but QA Lead determines the failure is a false positive (e.g., transient test flake, stale test), QA Lead documents reasoning in verification.jsonl check entry: {c:\"gate-override\",r:\"pass\",ev:\"Gate reported FAIL due to [reason], manual verification confirms [evidence]\",cat:\"gate_override\"}. Gate overrides must be documented with evidence -- no silent overrides.' (5) Subsection '### Gate Result JSON Schema': 'Post-plan gate result fields: gl (gate_level: post-plan), r (result: PASS|FAIL|PARTIAL), plan (plan_id), tst (tests: {ps:N,fl:N}), mh (must_haves: {tr:N,ar:N,kl:N}), dur (duration_ms), dt (date). See references/qa-gate-integration.md for full documentation.' Keep all existing content unchanged. This is additive only.","ts":""}
{"id":"T2","tp":"auto","a":"Add Continuous QA section to agents/yolo-qa-code.md: (1) Post-task gate result consumption -- QA Code reads prior post-task gate JSONs to understand which tasks already passed unit tests, (2) Incremental verification -- when post-task gates have run, QA Code skips re-running unit tests and focuses on integration/pattern checks (Phase 2-3 only), (3) Gate result aggregation -- QA Code summarizes cumulative gate results in qa-code.jsonl. REQ-07 QA Code update.","f":["agents/yolo-qa-code.md"],"td":["T1"],"v":"Continuous QA section exists with gate result consumption and incremental verification","done":"QA Code continuous mode committed","spec":"File: agents/yolo-qa-code.md (modify). Location: Insert new section '## Continuous QA (Gate Result Consumption)' AFTER the existing '## Escalation Table' section (after line 88) and BEFORE '## Teammate API'. Content: (1) Opening paragraph: 'When post-task gates have run during Step 7, their results are available in {phase-dir}/.qa-gate-results.jsonl. QA Code uses these to avoid redundant test execution and focus on higher-value checks.' (2) Subsection '### Post-Task Gate Result Reading': 'Read .qa-gate-results.jsonl. Filter entries where gl=post-task. For each task, check r field: PASS means unit tests passed for that task during implementation. FAIL means tests failed (should have been remediated before reaching Step 9). WARN means no test infrastructure was available. Aggregate: count PASS/FAIL/WARN entries per plan.' (3) Subsection '### Phase 0 Optimization (Cached Pass)': 'If ALL post-task gate results for a plan show r=PASS, Phase 0 TDD compliance can report a cached pass: {\"tdd\":{\"covered\":N,\"total\":N,\"missing\":[],\"cached\":true}}. The cached flag indicates results came from gate history, not a fresh test run. IMPORTANT: still run the full test suite once as Phase 1 validation -- cached pass applies to Phase 0 TDD compliance check only, not to the actual test execution in Phase 1. Rationale: post-task gates ran scoped tests (--scope flag), not the full suite. Phase 1 must confirm full suite still passes.' (4) Subsection '### Gate Result Aggregation in qa-code.jsonl': 'Add gate_summary field to qa-code.jsonl line 1 (summary): {\"gate_summary\":{\"post_task\":{\"pass\":N,\"fail\":N,\"warn\":N},\"post_plan\":{\"pass\":N,\"fail\":N}}}. This aggregation gives QA Lead and Lead visibility into continuous QA health across the phase.' (5) Subsection '### Gate Result JSON Schema': 'Post-task gate result fields: gl (gate_level: post-task), r (result: PASS|FAIL|WARN), plan (plan_id), task (task_id), tst (tests: {ps:N,fl:N}), dur (duration_ms), dt (date). See references/qa-gate-integration.md for full documentation.' All existing content unchanged. Additive only.","ts":""}
{"id":"T3","tp":"auto","a":"Update QA Lead verification protocol in yolo-qa.md to reference qa-gate-integration.md for gate trigger points. Add gate result files to the Receives context table: post-task gate results (JSON files), post-plan gate result (JSON). Ensure QA Lead knows where gate results are stored and how to parse them.","f":["agents/yolo-qa.md"],"td":["T1"],"v":"Context table includes gate result files, verification protocol references integration doc","done":"QA Lead context and references updated","spec":"File: agents/yolo-qa.md (modify). Two changes: (1) Update the '## Context' table at the bottom of the file (line 121-125). In the 'Receives' cell, append: ' + .qa-gate-results.jsonl (post-plan gate results) + references/qa-gate-integration.md (gate trigger documentation)'. The updated Receives cell should read: 'plan.jsonl + summary.jsonl + all output artifacts for the phase (test files, code, docs) + .qa-gate-results.jsonl (post-plan gate results) + references/qa-gate-integration.md (gate trigger documentation)'. (2) In the '## Verification Protocol' section (line 28), add a bullet to the 'Standard' tier: '+ gate result cross-reference (.qa-gate-results.jsonl analysis)'. In the 'Deep' tier: '+ gate override audit (verify all gate overrides have documented evidence)'. These additions tell QA Lead that gate results are available context and what to do with them at each tier level.","ts":""}
{"id":"T4","tp":"auto","a":"Update QA Code verification protocol in yolo-qa-code.md Phase 0 (TDD Compliance) to check post-task gate results first: if all tasks have passing post-task gate results, Phase 0 can report cached pass instead of re-running tests. Add gate result files to the Receives context table. Update Phase 1 to aggregate gate data into qa-code.jsonl summary.","f":["agents/yolo-qa-code.md"],"td":["T2"],"v":"Phase 0 checks gate results first, context table includes gate files, Phase 1 aggregates","done":"QA Code Phase 0 gate optimization committed","spec":"File: agents/yolo-qa-code.md (modify). Three changes: (1) Update '### Phase 0: TDD Compliance (all tiers)' section (lines 24-33). Add new step before existing step 1: '0. **Gate result pre-check:** Read {phase-dir}/.qa-gate-results.jsonl. Filter gl=post-task entries. If ALL tasks in test-plan.jsonl have corresponding post-task gate entries with r=PASS, report cached pass for TDD compliance: add cached:true to tdd field in summary. Skip steps 2-3 (file existence and test execution already verified by gates). Still proceed to step 4 (report) and Phase 1 (full suite validation). If any task has r=FAIL or r=WARN or is missing from gate results, fall through to existing steps 1-6 unchanged.' (2) Update '### Phase 1: Automated Checks (all tiers)' section (line 37). In step 1 (Test suite), add after the existing run logic: 'After running tests, aggregate gate result data: read .qa-gate-results.jsonl, count post-task and post-plan entries per result status, include gate_summary field in qa-code.jsonl line 1 summary (schema: {gate_summary:{post_task:{pass:N,fail:N,warn:N},post_plan:{pass:N,fail:N}}}).' (3) Update '## Context' table at the bottom (lines 156-160). In the 'Receives' cell, append: ' + .qa-gate-results.jsonl (post-task and post-plan gate results)'. Updated cell: 'plan.jsonl + summary.jsonl + all output artifacts for the phase + gaps.jsonl (from prior cycle) + .qa-gate-results.jsonl (post-task and post-plan gate results)'.","ts":""}
