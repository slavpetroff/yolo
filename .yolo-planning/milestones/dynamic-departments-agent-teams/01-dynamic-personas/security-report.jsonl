{"r":"PASS","findings":8,"critical":0,"high":0,"medium":3,"low":5,"dt":"2026-02-16"}
{"cat":"injection","sev":"medium","f":"scripts/generate-department-toons.sh","line":"128-137","issue":"awk template substitution uses unvalidated user input from JSON values. Special awk metacharacters in project-types.json values (like backslashes, quotes) could break gsub() rendering","fix":"Validate/sanitize JSON values before passing to awk, or use jq for template rendering instead of shell text processing","exploit":"If project-types.json contains backend.language='foo\"; print \"INJECTED\"}'  the awk gsub could be exploited"}
{"cat":"injection","sev":"low","f":"scripts/detect-stack.sh","line":"88-89","issue":"Pattern string from JSON passed to cut command. Malicious JSON could inject unexpected separators, but impact limited since cut is simple parser","fix":"Use jq array extraction instead of cut for colon-split patterns","exploit":"Unlikely: cut is positional-only, hard to exploit for RCE"}
{"cat":"path-traversal","sev":"low","f":"scripts/generate-department-toons.sh","line":"37,43,94","issue":"PROJECT_DIR argument not validated against directory traversal (../ sequences). Could write TOONs outside project boundary","fix":"Canonicalize PROJECT_DIR with realpath and validate it's within expected boundary","exploit":"./generate-department-toons.sh '../../etc' could write to /etc/.yolo-planning/departments/"}
{"cat":"race-condition","sev":"low","f":"scripts/generate-department-toons.sh","line":"80-92","issue":"TOCTOU race between hash file read and TOON writes. Concurrent invocations could corrupt output","fix":"Use flock or atomic write pattern (write to temp, then mv)","exploit":"Parallel ./generate-department-toons.sh calls could produce malformed TOONs"}
{"cat":"information-disclosure","sev":"low","f":"scripts/detect-stack.sh","line":"52-78","issue":"Reads full content of package.json, requirements.txt, etc. into memory. Could expose sensitive data in error messages if file parsing fails","fix":"Use streaming jq parsing instead of full file slurp. Ensure error messages don't echo file contents","exploit":"Error output could leak credentials if manifest files contain secrets"}
{"cat":"file-permission","sev":"info","f":"scripts/generate-department-toons.sh","line":"95,137,151,187","issue":"Generated TOONs inherit umask permissions. Could be world-readable if umask is 0022","fix":"Explicitly set output file permissions with chmod 0600 after creation","exploit":"World-readable TOONs could expose project structure to other users on shared systems"}
{"cat":"dependency-safety","sev":"medium","f":"scripts/detect-stack.sh","line":"39,69-77","issue":"Uses ls, shasum, sha256sum from PATH without absolute paths. PATH manipulation could hijack these commands","fix":"Use absolute paths (/usr/bin/ls, /usr/bin/shasum) or validate PATH at script start","exploit":"Attacker with PATH control could replace ls with malicious binary"}
{"cat":"denial-of-service","sev":"medium","f":"scripts/compile-context.sh","line":"291-308","issue":"Monorepo sub-directory loop (line 291) has no depth limit. Deeply nested directories or symlink loops could cause infinite recursion","fix":"Add depth limit (e.g., maxdepth 2 on directory traversal) and check for symlink loops","exploit":"Symlink loop in packages/ directory could hang script indefinitely"}
{"cat":"shell-safety","sev":"info","f":"all shell scripts","issue":"All scripts use set -euo pipefail and quote variables consistently. No word-splitting vulnerabilities detected","recommendation":"Good OWASP shell scripting practices observed. Continue this pattern"}
