phase: 03
goal: Offload more LLM work to scripts, reorganize references into department packages, adapt agent tool permissions per project type


decisions:
  | Decision | Date | Rationale |
  |----------|------|-----------|
  | Extensible project type config (7 types + custom) | 2026-02-16 | Users can add custom types via JSON config |
  | Hybrid TOON generation (init + refresh) | 2026-02-16 | Fast agent spawn + auto-refresh on stack change |
  | Wave 1 parallel (config + templates) | 2026-02-16 | No file conflicts, faster planning |
  | 4 plans, 2 waves (scripts+packages W1, permissions+integration W2) | 2026-02-16 | Wave 1 has zero file overlap; Wave 2 depends on Wave 1 outputs |
  | 3 offload scripts: validate-plan, validate-gates, generate-execution-state | 2026-02-16 | Highest token savings: plan validation, gate checking, state generation |
  | Per-role reference packages as static TOON in references/packages/ | 2026-02-16 | Deterministic extracts from execute-protocol.md, avoids runtime overhead |
  | Runtime tool permission resolution (config+script, not YAML modification) | 2026-02-16 | Preserves static agent YAMLs, enables dynamic per-project adaptation |

success_criteria: At least 3 new validation/generation scripts replace LLM work, department references reorganized into self-contained packages, agent tool permissions adapt to detected project type, measurable token reduction per phase execution
