---
phase: 3
plan: 2
title: "Config data file consistency fixes"
wave: 1
depends_on: []
must_haves:
  - REQ-09
  - Phantom roles removed from token-budgets.json
  - Placeholder skill names documented in stack-mappings.json
  - model-profiles.json naming inconsistency documented
---

# Plan 03-02: Config Data File Consistency Fixes

## Scope

Fix data inconsistencies in config JSON files other than the schema: remove phantom roles from token-budgets.json, fix placeholder skill names in stack-mappings.json, and document the model-profiles naming discrepancy.

**Files modified:** `config/token-budgets.json`, `config/stack-mappings.json`
**Files produced:** `.yolo-planning/phases/03-config-test-audit/03-02-model-profiles-NOTE.md`

## Tasks

### Task 1: Remove phantom roles from token-budgets.json

**Description:** The `role_families.execution` array contains `"senior"` and `"security"` — neither role exists in model-profiles.json, agent definitions, or agent_max_turns. These are remnants of the multi-department architecture that was simplified. Remove them from the execution array. Before removing, grep the Rust source to confirm no code path references these role family entries.

**Files:** `config/token-budgets.json`

**Commit:** `fix(config): remove phantom senior and security roles from token-budgets`

**Verification:**
- `jq '.role_families.execution' config/token-budgets.json` does not contain "senior" or "security"
- `jq '.role_families.execution' config/token-budgets.json` still contains dev, qa, debugger
- Grep Rust source for `"senior"` and `"security"` in role_families context returns no hits
- Existing `token-budgets.bats` tests still pass

### Task 2: Add TODO markers to stack-mappings.json placeholder skills

**Description:** All 30+ skill references in stack-mappings.json use generic placeholder names like `"python-skill"`, `"rust-skill"`, `"react-skill"` etc. These do not match actual skill marketplace IDs (real skills use names like `python-backend`, `rust-best-practices`). Since we do not know all correct marketplace skill IDs, add a top-level `_todo` field documenting the issue: `"_todo": "Skill names are placeholders — map to actual marketplace skill IDs when skill registry is available"`. Also add inline comments via `_skill_status: "placeholder"` fields in each language entry that uses a generic name. This preserves the structure while flagging the issue for future remediation.

**Files:** `config/stack-mappings.json`

**Commit:** `docs(config): flag placeholder skill names in stack-mappings for future fix`

**Verification:**
- `jq '._todo' config/stack-mappings.json` returns the TODO string
- File is still valid JSON (parseable by jq)
- Existing detect-stack.bats tests still pass (stack-mappings structure unchanged)

### Task 3: Fix duplicate mobile key in stack-mappings.json

**Description:** The stack-mappings.json file has a duplicate `"mobile"` key at the top level (lines 232-258 duplicate/override lines 232-257). JSON allows this but the first definition is silently discarded. Merge the two `mobile` objects into one, keeping the more detailed detection patterns from the second definition (expanded xcodeproj/xcworkspace glob patterns, ContentView.swift detection for SwiftUI) while preserving all entries from the first (android-kotlin, flutter, react-native).

**Files:** `config/stack-mappings.json`

**Commit:** `fix(config): merge duplicate mobile key in stack-mappings.json`

**Verification:**
- `jq '.mobile | keys' config/stack-mappings.json` contains all: ios-swift, swiftui, android-kotlin, flutter, react-native
- No duplicate top-level keys in the file (only one `"mobile"` section)
- File is valid JSON

### Task 4: Document model-profiles naming discrepancy

**Description:** The third tier in model-profiles.json is named `"budget"` but the schema (before Plan 01 fixes it) called it `"speed"`, and references/model-profiles.md may also reference `"speed"`. Since Plan 01 will fix the schema to say `"budget"`, document the naming history so future editors know the canonical name is `"budget"`. Create a brief note file in the phase directory.

**Files:** `.yolo-planning/phases/03-config-test-audit/03-02-model-profiles-NOTE.md`

**Commit:** `docs(config): document model-profiles budget vs speed naming resolution`

**Verification:**
- Note file exists and explains the naming decision
- model-profiles.json continues to use `"budget"` (no change to the file itself)
