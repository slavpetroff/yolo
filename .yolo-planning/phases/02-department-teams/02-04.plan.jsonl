{"p":"02","n":"04","t":"Tests: agent section validation, dept-orchestrate teammate routing, mock integration","w":2,"d":["02-01","02-02","02-03"],"xd":[{"p":"01","n":"04","a":"tests/unit/resolve-team-mode.bats","r":"Test pattern reference for team_mode-related bats tests"}],"mh":{"tr":["Static tests verify all 15 agents (4 from Phase 1 + 11 from Phase 2) have Teammate API sections","Unit tests verify dept-orchestrate outputs team_mode and spawn_strategy fields","Mock integration tests validate spawnTeam/SendMessage patterns are documented consistently","All 957+ existing tests pass unchanged (zero regression)"],"ar":[{"p":"tests/static/agent-teammate-sections.bats","pv":"@test","c":"static tests checking all 15 agent files for Teammate API section presence"},{"p":"tests/unit/dept-orchestrate-teammate.bats","pv":"@test","c":"unit tests for team_mode routing in dept-orchestrate spawn plans"},{"p":"tests/integration/teammate-mock.bats","pv":"@test","c":"mock integration tests validating spawnTeam/SendMessage pattern consistency"}],"kl":[{"fr":"tests/static/agent-teammate-sections.bats","to":"agents/yolo-*.md","vi":"tests check every yolo-*.md agent file for ## Teammate API"},{"fr":"tests/unit/dept-orchestrate-teammate.bats","to":"scripts/dept-orchestrate.sh","vi":"tests invoke dept-orchestrate.sh with team_mode configs"},{"fr":"tests/integration/teammate-mock.bats","to":"references/teammate-api-patterns.md","vi":"tests validate pattern consistency across agents and reference docs"}]},"obj":"Comprehensive test coverage for Phase 2: static validation of agent Teammate API sections, unit tests for dept-orchestrate teammate routing, mock integration tests for spawnTeam/SendMessage pattern consistency. Plus full regression run.","sk":["commit"],"fm":["tests/static/agent-teammate-sections.bats","tests/unit/dept-orchestrate-teammate.bats","tests/integration/teammate-mock.bats"],"auto":true}
{"id":"T1","tp":"auto","a":"Create tests/static/agent-teammate-sections.bats: verify all 15 agent files (lead, dev, senior, architect from Phase 1 + tester x3, qa x3, qa-code x3, security, owner from Phase 2) contain '## Teammate API' section. Verify each section contains 'team_mode=teammate' guard text. Verify each section references @references/teammate-api-patterns.md (except owner which uses file-based).","f":["tests/static/agent-teammate-sections.bats"],"v":"All tests pass, covering 15 agent files for section presence","done":"Static agent Teammate API section tests created and green, committed"}
{"id":"T2","tp":"auto","a":"Create tests/unit/dept-orchestrate-teammate.bats: test dept-orchestrate.sh with team_mode=teammate config. Verify output includes team_mode field. Verify each wave dept has spawn_strategy=spawnTeam and team_name=yolo-{dept}. Test backward compatibility: team_mode=task config produces unchanged output (no spawn_strategy field or spawn_strategy=task). Test edge cases: missing team_mode in config defaults to task behavior.","f":["tests/unit/dept-orchestrate-teammate.bats"],"v":"All tests pass covering teammate routing, task fallback, and edge cases","done":"dept-orchestrate teammate routing tests created and green, committed"}
{"id":"T3","tp":"auto","a":"Create tests/integration/teammate-mock.bats: mock integration tests that validate pattern consistency. Test 1: all SendMessage schemas referenced in agent files match schemas in handoff-schemas.md. Test 2: all agent Teammate API escalation targets match their hierarchy (tester->senior, qa->lead, etc). Test 3: cross-team-protocol transport table entries match agent Teammate API sections. Test 4: teammate-api-patterns.md registration order includes all Phase 2 agents.","f":["tests/integration/teammate-mock.bats"],"v":"All mock integration tests pass","done":"Mock integration tests created and green, committed"}
{"id":"T4","tp":"auto","a":"Run full regression test suite (all 957+ tests) to confirm zero regression. Fix any failures found in Phase 2 changes. Document test count in summary.","f":[],"v":"All tests pass: 957+ existing + new Phase 2 tests","done":"Full regression passes with zero failures, test count documented"}
