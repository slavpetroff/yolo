{"p":"03","n":"02","t":"Reference Package Reorganization","w":1,"d":[],"xd":[],"mh":{"tr":["Each agent role has a self-contained reference package TOON file","Package files are smaller than the full reference files they replace","compile-context.sh references packages instead of full reference tree","No agent prompt includes execute-protocol.md (30KB) or company-hierarchy.md (16KB) in full"],"ar":[{"p":"references/packages/dev.toon","pv":"file exists and is non-empty","c":"self-contained Dev reference: only task execution protocol, commit format, escalation to Senior"},{"p":"references/packages/senior.toon","pv":"file exists and is non-empty","c":"self-contained Senior reference: design review + code review protocol, spec enrichment format"},{"p":"references/packages/qa.toon","pv":"file exists and is non-empty","c":"self-contained QA reference: verification protocol, must-have checking, tier resolution"},{"p":"scripts/build-reference-packages.sh","pv":"file exists and is executable","c":"script that generates per-role reference packages from source reference files"}],"kl":[{"fr":"references/packages/dev.toon","to":"references/execute-protocol.md","vi":"contains only Step 6 implementation protocol extract"},{"fr":"references/packages/senior.toon","to":"references/execute-protocol.md","vi":"contains only Step 4 and Step 7 protocol extracts"},{"fr":"scripts/build-reference-packages.sh","to":"references/execute-protocol.md","vi":"extracts per-step protocol sections into role packages"}]},"obj":"Reorganize the large reference files (execute-protocol.md 30KB, company-hierarchy.md 16KB, artifact-formats.md 16KB) into per-role self-contained reference packages. Each agent loads only its package. REQ-05.","sk":["commit"],"fm":["references/packages/architect.toon","references/packages/lead.toon","references/packages/senior.toon","references/packages/dev.toon","references/packages/tester.toon","references/packages/qa.toon","references/packages/qa-code.toon","references/packages/critic.toon","references/packages/security.toon","scripts/build-reference-packages.sh","tests/unit/build-reference-packages.bats"],"auto":true}
{"id":"T1","tp":"auto","a":"Create scripts/build-reference-packages.sh: extracts per-role reference packages from source reference files. For each role (architect, lead, senior, dev, tester, qa, qa-code, critic, security), extract only the relevant sections from execute-protocol.md (the step they participate in), company-hierarchy.md (their escalation chain), and artifact-formats.md (the schemas they produce/consume). Output: references/packages/{role}.toon files. Uses awk to extract sections by step header. REQ-05.","f":["scripts/build-reference-packages.sh"],"v":"Script generates 9 package files; each is smaller than 3KB; each contains only the role's relevant protocol sections","done":"Script extracts per-role packages from large reference files"}
{"id":"T2","tp":"auto","a":"Generate the 9 reference package TOON files via build-reference-packages.sh. Dev package (~1KB): Step 6 protocol, commit format, escalation to Senior, summary.jsonl schema. Senior package (~2KB): Step 4 design review + Step 7 code review protocol, spec/ts field format, code-review.jsonl schema. QA package (~1.5KB): Step 8 protocol, verification tiers, verification.jsonl schema, remediation loop. Architect package (~2KB): Step 2 protocol, architecture.toon format, decision logging. Lead package (~2KB): Step 3 load plans + Step 10 sign-off, plan.jsonl schema, wave ordering. Tester package (~1.5KB): Step 5 protocol, test-plan.jsonl schema, RED phase confirmation. QA-Code package (~1.5KB): Step 8 code-level protocol, qa-code.jsonl schema, TDD compliance checks. Critic package (~1KB): Step 1 protocol, critique.jsonl schema. Security package (~1KB): Step 9 protocol, security-audit.jsonl schema. REQ-05.","f":["references/packages/architect.toon","references/packages/lead.toon","references/packages/senior.toon","references/packages/dev.toon","references/packages/tester.toon","references/packages/qa.toon","references/packages/qa-code.toon","references/packages/critic.toon","references/packages/security.toon"],"v":"All 9 files exist, each under 3KB, no file references the full execute-protocol.md","done":"9 per-role reference packages generated, each self-contained"}
{"id":"T3","tp":"auto","a":"Create tests/unit/build-reference-packages.bats: test suite for package generation. Tests: script generates all 9 files, each file is non-empty, each file is under 3KB, dev package contains Step 6 but NOT Step 2/4/7/8/9, senior package contains Step 4 and Step 7 but NOT Step 6, qa package contains Step 8 but NOT Step 6, each package contains its role's artifact schema, no package exceeds token budget, regeneration is idempotent. REQ-05.","f":["tests/unit/build-reference-packages.bats"],"v":"bats tests/unit/build-reference-packages.bats passes all tests","done":"10+ BATS tests verifying reference package generation correctness"}
