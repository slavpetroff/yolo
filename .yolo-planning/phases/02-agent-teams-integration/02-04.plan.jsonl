{"p":"02-04","n":"Go.md Integration and End-to-End Wiring","t":5,"w":3,"d":["02-01","02-02","02-03"],"mh":{"tr":["go.md Execute mode uses spawnTeam dispatch when agent_teams=true and multi_dept=true","go.md Plan mode spawns department leads as team leads (not individual Task agents)","3 department teams can run in parallel (21+ agent capacity)","Graceful shutdown on phase completion, crash, or error","resolve-departments.sh output extended with team_spawn_plan","Existing single-dept execution (Task tool) works identically when agent_teams=false"],"ar":[{"p":"commands/go.md","pv":"grep -c 'spawn-team.sh' commands/go.md returns at least 1","c":"go.md references spawn-team.sh for team-based execution"},{"p":"scripts/resolve-departments.sh","pv":"bash scripts/resolve-departments.sh .yolo-planning/config.json | grep team_spawn_plan outputs spawn plan","c":"resolve-departments outputs team_spawn_plan field"},{"p":"references/execute-protocol.md","pv":"grep 'Team-Based Execution' references/execute-protocol.md returns match","c":"execute-protocol has Team-Based Execution section"}],"kl":[{"fr":"commands/go.md","to":"scripts/spawn-team.sh","vi":"go.md calls spawn-team.sh during multi-dept execute"},{"fr":"commands/go.md","to":"scripts/shutdown-team.sh","vi":"go.md calls shutdown-team.sh at phase end or on error"},{"fr":"scripts/resolve-departments.sh","to":"commands/go.md","vi":"go.md reads resolve-departments output to determine team spawn plan"},{"fr":"commands/go.md","to":"references/execute-protocol.md","vi":"go.md delegates to execute-protocol for 10-step workflow"}]},"obj":"Wire team lifecycle into go.md Execute and Plan modes, extend resolve-departments.sh with team spawn planning, and ensure end-to-end flow from config -> department detection -> team spawn -> parallel execution -> graceful shutdown.","sk":["commit"],"fm":["commands/go.md","scripts/resolve-departments.sh","tests/unit/resolve-departments-teams.bats","tests/integration/team-lifecycle.bats","config/defaults.json"]}
{"id":"02-04-01","n":"Extend resolve-departments.sh with team spawn plan","f":["scripts/resolve-departments.sh"],"d":[],"ac":["resolve-departments.sh outputs new field: team_spawn_plan (JSON array of team spawn instructions)","Each entry: {dept, lead_agent, team_size, wave}","When agent_teams=false: team_spawn_plan=[] (empty, fallback mode)","When agent_teams=true and multi_dept=true: team_spawn_plan has one entry per active department","Wave assignment follows existing leads_to_spawn logic (UX=wave1, FE+BE=wave2 for parallel)","Backward compatible: all existing output fields unchanged","config/defaults.json agent_teams field documented with comment"]}
{"id":"02-04-02","n":"Update go.md Execute mode for team dispatch","f":["commands/go.md"],"d":["02-04-01"],"ac":["go.md Execute mode reads agent_teams and multi_dept flags","When both true: calls spawn-team.sh per department (following team_spawn_plan from resolve-departments.sh)","Captures team_ids in .execution-state.json departments.{dept}.team_id","Dispatches 10-step workflow to department team leads via SendMessage instead of Task tool","On phase completion (Step 10): calls shutdown-team.sh per active team_id","On error/crash: calls shutdown-team.sh with --force flag for immediate cleanup","When agent_teams=false OR multi_dept=false: existing Task tool flow preserved unchanged","go.md Plan mode: when multi_dept=true, spawns department leads with team context"]}
{"id":"02-04-03","n":"Update execution state schema for team tracking","f":["scripts/state-updater.sh"],"d":["02-04-01"],"ac":["state-updater.sh handles .execution-state.json with team fields","New department fields: departments.{dept}.team_id, departments.{dept}.status, departments.{dept}.agents[]","state-updater tracks team spawn and shutdown events","On summary write: checks if all plans in department are complete, updates department status","Backward compatible: when no team fields present, existing behavior unchanged","Uses jq for all JSON manipulation (no grep/sed on JSON)"]}
{"id":"02-04-04","n":"Write resolve-departments team extension tests","f":["tests/unit/resolve-departments-teams.bats"],"d":["02-04-01"],"ac":["tests/unit/resolve-departments-teams.bats has minimum 8 tests","Tests cover: agent_teams=true with 3 depts outputs team_spawn_plan with 3 entries, agent_teams=false outputs empty team_spawn_plan, backend-only outputs single team entry, parallel workflow assigns correct waves, sequential workflow assigns sequential waves, team_spawn_plan entries have dept+lead_agent+team_size+wave fields, existing output fields unchanged, missing config graceful fallback","All tests pass with bats"]}
{"id":"02-04-05","n":"Write end-to-end team lifecycle integration test","f":["tests/integration/team-lifecycle.bats"],"d":["02-04-01","02-04-02","02-04-03"],"ac":["tests/integration/team-lifecycle.bats has minimum 5 tests","Tests cover: full lifecycle (resolve-depts -> spawn-team -> state-update -> shutdown-team), fallback mode (agent_teams=false runs Task tool path), team_id appears in .execution-state.json after spawn, shutdown clears team state, parallel department detection (3 depts produce 3 team entries)","Tests use fixture configs and mock team outputs","All tests pass with bats"]}
