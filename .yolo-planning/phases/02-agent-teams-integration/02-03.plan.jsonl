{"p":"02-03","n":"Protocol Updates for Teammate API","t":5,"w":2,"d":["02-01","02-02"],"mh":{"tr":["execute-protocol.md Step 6 uses spawnTeam when agent_teams=true and multi_dept=true","multi-dept-protocol.md dispatch section uses per-department teams instead of sequential Task spawns","cross-team-protocol.md handoff gates use TaskList for cross-department artifact checks","Execution state tracks department team_ids and per-team agent status","Single-dept mode with agent_teams=false remains unchanged (Task tool path preserved)"],"ar":[{"p":"references/execute-protocol.md","pv":"grep -c 'spawnTeam' references/execute-protocol.md returns at least 2","c":"execute-protocol references spawnTeam for team-based execution"},{"p":"references/multi-dept-protocol.md","pv":"grep -c 'spawn-team.sh' references/multi-dept-protocol.md returns at least 1","c":"multi-dept-protocol references spawn-team.sh for department team creation"},{"p":"references/cross-team-protocol.md","pv":"grep -c 'TaskList' references/cross-team-protocol.md returns at least 2","c":"cross-team-protocol uses TaskList for handoff coordination"},{"p":"references/execute-protocol.md","pv":"grep 'shutdown-team.sh' references/execute-protocol.md returns match in Step 10","c":"Step 10 Sign-off includes team shutdown"}],"kl":[{"fr":"references/execute-protocol.md","to":"scripts/spawn-team.sh","vi":"execute-protocol calls spawn-team.sh during implementation step"},{"fr":"references/multi-dept-protocol.md","to":"references/cross-team-protocol.md","vi":"multi-dept dispatch references cross-team handoff gates"},{"fr":"references/execute-protocol.md","to":"scripts/shutdown-team.sh","vi":"Step 10 calls shutdown-team.sh for graceful cleanup"}]},"obj":"Update the three core protocol documents (execute-protocol.md, multi-dept-protocol.md, cross-team-protocol.md) to use Teammate API patterns: spawnTeam for department teams, TaskList+SendMessage for coordination, and graceful shutdown at phase end.","sk":["commit"],"fm":["references/execute-protocol.md","references/multi-dept-protocol.md","references/cross-team-protocol.md","references/company-hierarchy.md","references/artifact-formats.md"]}
{"id":"02-03-01","n":"Update execute-protocol.md for team-based execution","f":["references/execute-protocol.md"],"d":[],"ac":["Step 6 (Implementation) gains conditional: if agent_teams=true AND multi_dept=true, use spawnTeam per department instead of Task tool","Step 6 documents team spawn pattern: resolve team-profiles, call spawn-team.sh, capture team_ids","Step 10 (Sign-off) gains team shutdown: call shutdown-team.sh per active team_id","New section: Team-Based Execution State with team_ids tracked in .execution-state.json","Context Scoping table updated: team members receive context via team lead, not individual Task prompts","Execution State Transitions table updated: new department.team_id field","Existing single-dept Task tool path preserved with clear conditional branching"]}
{"id":"02-03-02","n":"Update multi-dept-protocol.md for team dispatch","f":["references/multi-dept-protocol.md"],"d":["02-03-01"],"ac":["Step 0 updated: Owner Context Gathering unchanged","Steps 1-10 updated: each department dispatched via spawnTeam (not sequential Task spawns)","Per-Department 10-Step Execution section: team lead runs local 10-step, delegates to teammates","New section: Department Team Lifecycle (per-phase spawn, phase-end shutdown)","New section: Team-Based Execution State Extensions (.execution-state.json gains departments.{dept}.team_id)","Integration QA section updated: cross-team verification uses TaskList to check all departments complete","Owner Sign-off section updated: Owner sends shutdown to all team leads via SendMessage"]}
{"id":"02-03-03","n":"Update cross-team-protocol.md for TaskList+SendMessage coordination","f":["references/cross-team-protocol.md"],"d":["02-03-01"],"ac":["Handoff Gate 1 (UX -> FE+BE) updated: uses TaskList to verify UX team completion status","Handoff Gate 2 (FE <-> BE API Contract) updated: Leads use SendMessage for contract negotiation","Handoff Gate 3 (Integration QA) updated: TaskList aggregation of all department results","Communication Rules updated: Lead-to-Lead direct SendMessage now explicitly permitted for handoff coordination","New section: TaskList Coordination Patterns (how departments check each other's status)","New section: SendMessage Handoff Schema (message types for handoff_ready, contract_proposed, contract_agreed)"]}
{"id":"02-03-04","n":"Update company-hierarchy.md and artifact-formats.md","f":["references/company-hierarchy.md","references/artifact-formats.md"],"d":["02-03-01"],"ac":["company-hierarchy.md Agent Roster table gains Team column (which team each agent belongs to)","company-hierarchy.md Team Structure section updated: teams are Teammate API teams, not just logical groupings","company-hierarchy.md Multi-Department Structure section: teams spawned via spawnTeam, 21+ total capacity","artifact-formats.md gains team-state schema: {team_id, dept, agents[], status, spawned_at, shutdown_at}","artifact-formats.md Execution State Extensions: departments.{dept}.team_id field documented","artifact-formats.md Phase Directory Structure: .team-state.json added"]}
{"id":"02-03-05","n":"Write protocol validation tests","f":["tests/static/protocol-team-refs.bats"],"d":["02-03-01","02-03-02","02-03-03","02-03-04"],"ac":["tests/static/protocol-team-refs.bats has minimum 8 tests","Tests cover: execute-protocol.md contains spawnTeam reference, execute-protocol.md contains shutdown-team.sh reference, multi-dept-protocol.md contains spawn-team.sh reference, cross-team-protocol.md contains TaskList reference, company-hierarchy.md contains team capacity reference (21+), artifact-formats.md contains team-state schema, execute-protocol.md preserves Task tool fallback path, cross-team-protocol.md contains SendMessage handoff schema","All tests use grep/file-content assertions","All tests pass with bats"]}
