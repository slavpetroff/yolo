{"p":"02","n":"02","t":"Research artifact format and Scout workflow enhancement","w":1,"d":[],"xd":[],"mh":{"tr":["research.jsonl schema in artifact-formats.md includes a brief_for field linking findings to critique IDs","yolo-scout.md documents the in-workflow research protocol (not just standalone /yolo:research)","Research findings include critique-ID cross-references when Critic findings drive the research","Pre-Critic research mode is supported (best-practices discovery before gap analysis)"],"ar":[{"p":"references/artifact-formats.md","pv":"research.jsonl schema has brief_for field","c":"critique-linked research findings"},{"p":"agents/yolo-scout.md","pv":"contains 'In-Workflow Research' section","c":"Scout protocol for execute-protocol Step 2"}],"kl":[{"fr":"agents/yolo-scout.md In-Workflow Research","to":"references/execute-protocol.md Step 2","vi":"Scout agent references execute-protocol research step"},{"fr":"references/artifact-formats.md research.jsonl","to":"references/artifact-formats.md critique.jsonl","vi":"brief_for field links research findings to critique IDs"}]},"obj":"Enhance research.jsonl schema and Scout agent to support critique-driven research briefs and pre-Critic best-practices discovery","sk":["commit"],"auto":true}
{"id":"T1","tp":"auto","a":"Enhance research.jsonl schema in artifact-formats.md (REQ-03). Add fields: brief_for (critique ID that prompted research, optional), mode (pre-critic or post-critic), priority (high/medium/low based on critique severity). Update existing schema table.","f":["references/artifact-formats.md"],"v":"research.jsonl schema in artifact-formats.md includes brief_for, mode, priority fields","done":"Research schema enhanced with critique linkage fields","spec":"FILE: references/artifact-formats.md (MODIFY). Single location: the '### Research (research.jsonl)' section starting at line 203. CURRENT TABLE (lines 205-212): The research.jsonl schema table has 6 fields: q, src, finding, conf, dt, rel. ADD 3 NEW ROWS to the table AFTER the existing `rel` row (after line 212). Each new field is OPTIONAL with jq // defaults per architecture decision D4: | `brief_for` | brief_for | string | \"C1\" | then | `mode` | mode | string | \"post-critic\" | then | `priority` | priority | string | \"high\" |. After the table, ADD a new paragraph (between the table end and the '### Gaps' heading at line 214) with the following text: 'New fields (D4): `brief_for` links a research finding to the critique ID (from critique.jsonl) that prompted the research. `mode` indicates when research was performed: \"pre-critic\" (best-practices discovery before Critic runs), \"post-critic\" (solution research driven by Critic findings), or \"standalone\" (via /yolo:research command). `priority` is derived from the linked critique finding severity when `brief_for` is present: critical -> \"high\", major -> \"medium\", minor -> \"low\". All three fields are optional; omitted fields default to empty/\"standalone\"/\"medium\" respectively via jq // operator. Existing standalone research entries (without these fields) continue to parse correctly.' ALSO UPDATE the state.json step field documentation at line 189. The current union type reads: \"critique\"|\"architecture\"|\"planning\"|\"design_review\"|\"test_authoring\"|\"implementation\"|\"code_review\"|\"qa\"|\"security\"|\"signoff\". Insert \"research\" after \"critique\" so it reads: \"critique\"|\"research\"|\"architecture\"|\"planning\"|\"design_review\"|\"test_authoring\"|\"implementation\"|\"code_review\"|\"qa\"|\"security\"|\"signoff\". This aligns with architecture decision D13. VERIFICATION: research.jsonl table should have 9 rows (6 original + 3 new). Explanatory paragraph should reference D4 and describe all three fields with defaults. Line 189 should include 'research' in the step union.","ts":"No automated tests for markdown documentation changes. Verification is manual: (1) Count rows in research.jsonl table in artifact-formats.md: should be 9 (q, src, finding, conf, dt, rel, brief_for, mode, priority). (2) Search for 'brief_for' in artifact-formats.md: should appear in table row and explanatory paragraph. (3) Search for 'standalone' in the research section: should appear describing the default mode value. (4) Line 189 union type should contain 'research' between 'critique' and 'architecture'."}
{"id":"T2","tp":"auto","a":"Add In-Workflow Research section to yolo-scout.md (REQ-03). Document: (1) post-Critic mode where Scout receives critique.jsonl findings and researches solutions/best-practices for open findings, (2) pre-Critic mode where Scout researches best-practices for the phase requirements before Critic runs, (3) output format using research.jsonl schema with brief_for cross-references.","f":["agents/yolo-scout.md"],"v":"yolo-scout.md has In-Workflow Research section with post-Critic and pre-Critic modes","done":"Scout agent prompt documents both research modes","spec":"FILE: agents/yolo-scout.md (MODIFY). Insert a NEW section '## In-Workflow Research' AFTER the '## Effort-Based Behavior' section (after line 49, before '## Escalation Table' at line 51). This documents Scout's role in execute-protocol Step 2 (Research), implementing D2 (orchestrator writes research.jsonl from Scout findings) and D3 (pre-Critic and post-Critic modes coexist). SECTION CONTENT: Heading '## In-Workflow Research' followed by intro: 'Scout is spawned during execute-protocol Step 2 (Research) to gather targeted intelligence for the Architect. Two modes:'. SUBSECTION 1: '### Post-Critic Mode (default workflow)' -- Triggered after Step 1 (Critique) completes. Scout receives critique.jsonl findings filtered to sev:critical and sev:major only (minor excluded per D7 to respect 1000-token budget). Protocol: (1) Read critique findings from compiled context (.ctx-scout.toon research_directives section). (2) For each critical/major finding: research best practices, solutions, prior art, ecosystem patterns. (3) Return structured findings to orchestrator with fields: q (query from critique finding), finding, conf, src, brief_for (critique ID e.g. C1 C3), mode (\"post-critic\"), priority (derived: critical->high, major->medium), rel, dt. (4) Orchestrator (go.md) writes research.jsonl from Scout findings (Scout is read-only per D2). SUBSECTION 2: '### Pre-Critic Mode' -- Triggered via /yolo:go --research-first before Critique. Protocol: (1) Read requirements from compiled context. (2) Research industry best practices, patterns, prior art for requirements. (3) Return findings with same fields EXCEPT: brief_for omitted (no critique yet), mode is \"pre-critic\", priority is \"medium\" (default). (4) Orchestrator appends to research.jsonl per D3 append mode. SUBSECTION 3: '### Output Format' -- Scout returns findings as structured data (task result or scout_findings schema in teammate mode). Orchestrator writes research.jsonl. Include example JSON: {\"q\":\"rate limiting best practices for REST APIs\",\"src\":\"web\",\"finding\":\"Token bucket algorithm with 429 status + Retry-After header is industry standard\",\"conf\":\"high\",\"brief_for\":\"C2\",\"mode\":\"post-critic\",\"priority\":\"high\",\"rel\":\"Addresses critique C2 rate limiting gap\",\"dt\":\"2026-02-17\"}. ALSO update the Context table (line 67-71). Current Receives cell: 'Research directives from Lead (specific questions, domains, technologies to investigate) + codebase mapping (for existing patterns)'. UPDATE to add: '+ critique.jsonl findings (critical/major only, in post-Critic mode via compiled context)'. VERIFICATION: (1) '## In-Workflow Research' heading exists. (2) Both Post-Critic and Pre-Critic subsections exist. (3) brief_for documented in output format. (4) Example JSON has all 9 fields. (5) D2, D3, D7 referenced. (6) Context table Receives includes critique.jsonl.","ts":"No automated tests for agent prompt markdown files. Verification is manual: (1) grep 'In-Workflow Research' agents/yolo-scout.md returns a match. (2) grep 'Post-Critic Mode' agents/yolo-scout.md returns a match. (3) grep 'Pre-Critic Mode' agents/yolo-scout.md returns a match. (4) grep 'brief_for' agents/yolo-scout.md returns matches in the finding field list and example JSON. (5) grep 'mode.*post-critic' agents/yolo-scout.md returns a match. (6) The Context table Receives cell mentions critique.jsonl."}
{"id":"T3","tp":"auto","a":"Update Critic agent (yolo-critic.md) to reference research step (REQ-03). Add note that Critic findings with sev=critical or sev=major auto-feed into Scout research directives. Add cross-reference to execute-protocol Step 2.","f":["agents/yolo-critic.md"],"v":"yolo-critic.md references research step and finding-to-research pipeline","done":"Critic agent documents research handoff","spec":"FILE: agents/yolo-critic.md (MODIFY). CHANGE 1: Insert a new subsection '### Research Handoff' AFTER the '### Severity Guide' section (after line 65, before '## Output Schema: critique.jsonl' at line 67). Content: 'Critic findings with sev:critical or sev:major automatically feed into Scout research directives during execute-protocol Step 2 (Research). The orchestrator filters critique.jsonl to critical/major severity and passes these as research directives to Scout. Scout researches solutions and best practices for each finding, producing research.jsonl entries with brief_for linking back to the critique ID (e.g., brief_for:C2 for a research finding prompted by critique C2). This means Critic most impactful findings directly drive targeted research. Minor findings are excluded from research directives to respect Scout 1000-token context budget. Note: Critic does not interact with Scout directly. The orchestrator (go.md) handles the handoff: Critic produces critique.jsonl (Step 1) -> orchestrator spawns Scout with filtered findings (Step 2) -> Scout produces research.jsonl -> Architect reads both artifacts (Step 3).' CHANGE 2: Verify Context table (lines 123-127). The Receives cell already includes 'research.jsonl (if exists)' at line 125. No change needed to Context table. VERIFICATION: (1) '### Research Handoff' heading exists in yolo-critic.md. (2) Text mentions critical and major severity feeding into Scout. (3) Text references Step 2 (Research) or execute-protocol Step 2. (4) Text mentions brief_for linking research findings back to critique IDs. (5) Handoff chain documented: Critic -> orchestrator -> Scout -> Architect.","ts":"No automated tests for agent prompt markdown files. Verification is manual: (1) grep 'Research Handoff' agents/yolo-critic.md returns a match. (2) grep 'brief_for' agents/yolo-critic.md returns a match. (3) grep 'Step 2' agents/yolo-critic.md returns a match referencing the research step. (4) The subsection is positioned between Severity Guide and Output Schema sections."}
{"id":"T4","tp":"auto","a":"Update Architect agent (yolo-architect.md) to document research.jsonl as enriched input (REQ-03). Add note that research.jsonl now includes critique-linked findings (brief_for field) alongside general research. Architect should prioritize high-confidence, critique-linked findings.","f":["agents/yolo-architect.md"],"v":"yolo-architect.md references enriched research.jsonl with brief_for field","done":"Architect agent documents critique-linked research consumption","spec":"FILE: agents/yolo-architect.md (MODIFY). Three changes required. CHANGE 1: Enhance step 1 (Load context) at line 30. Current text: 'Read requirements, codebase mapping (INDEX.md, ARCHITECTURE.md, PATTERNS.md, CONCERNS.md if exist), any prior research.' UPDATE to: 'Read requirements, codebase mapping (INDEX.md, ARCHITECTURE.md, PATTERNS.md, CONCERNS.md if exist), research.jsonl (if exists -- may include critique-linked findings with brief_for field cross-referencing critique IDs).' CHANGE 2: Add a new step 3 between current step 2 (Address critique, ending around line 34) and current step 3 (R&D, at line 35). New step: '3. **Consume research**: If research.jsonl exists in phase directory, read all entries. Research findings come in three modes: mode:post-critic -- Targeted research prompted by specific critique findings. These have a brief_for field linking to the critique ID (e.g., C1, C3). Prioritize high-confidence (conf:high) critique-linked findings when making architecture decisions. Reference both the critique ID and the research finding in decisions.jsonl. mode:pre-critic -- Best-practices research gathered before critique. No brief_for field. Use as general context for technology evaluation. mode:standalone (or mode field absent) -- Research from /yolo:research command. Treat as general reference material. All modes coexist in the same research.jsonl file (append mode per D3). All entries are useful context; critique-linked entries with high confidence should carry more weight in decisions.' Renumber subsequent steps: old 3 (R&D) becomes 4, old 4 (System design) becomes 5, old 5 (Phase decomposition) becomes 6, old 6 (Output) becomes 7, old 7 (Commit) becomes 8. CHANGE 3: Update Context table (lines 104-110). Current Receives cell: 'Lead plan structure + department CONTEXT (backend only) + critique.jsonl findings + codebase mapping + research.jsonl'. UPDATE to: 'Lead plan structure + department CONTEXT (backend only) + critique.jsonl findings + codebase mapping + research.jsonl (may include critique-linked entries with brief_for field and mode/priority fields)'. VERIFICATION: (1) Step 1 mentions brief_for or critique-linked findings. (2) New Consume research step exists between Address critique and R&D. (3) Three modes (post-critic, pre-critic, standalone) documented. (4) Guidance to prioritize high-confidence critique-linked findings present. (5) Context table Receives mentions brief_for or critique-linked entries. (6) Steps numbered sequentially 1-8 with no gaps.","ts":"No automated tests for agent prompt markdown files. Verification is manual: (1) grep 'Consume research' agents/yolo-architect.md returns a match. (2) grep 'brief_for' agents/yolo-architect.md returns at least 2 matches (in step 1 and step 3). (3) grep 'post-critic' agents/yolo-architect.md returns a match. (4) grep 'pre-critic' agents/yolo-architect.md returns a match. (5) grep 'standalone' agents/yolo-architect.md returns a match. (6) Steps numbered sequentially 1 through 8 with no gaps or duplicates."}
