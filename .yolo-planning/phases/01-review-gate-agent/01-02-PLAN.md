---
phase: "01"
plan: "02"
title: "Reviewer agent definition updates for two-stage integration"
wave: 1
depends_on: []
must_haves:
  - "Reviewer agent verdict format includes finding IDs for delta tracking"
  - "Reviewer agent has explicit two-stage awareness in its protocol"
  - "Review Checklist focuses on design quality not structural checks"
---

## Tasks

### Task 1: Update reviewer agent verdict format and protocol

**Files:** `agents/yolo-reviewer.md`

Update the yolo-reviewer agent definition to integrate with the two-stage review:

**1. Add finding IDs to verdict format.** Update the Verdict Format section so each finding includes an `id` field for stable delta tracking across feedback loop cycles:

```
VERDICT: approve|reject|conditional
FINDINGS:
- [id:f-001] [severity:high] [file:path] issue: description | suggestion: fix
- [id:f-002] [severity:medium] [file:path] issue: description | suggestion: fix
```

The `id` field is a short stable identifier (`f-001`, `f-002`, ...) assigned sequentially. During delta-aware review (cycle > 1), reuse IDs from previous findings for persistent issues; assign new IDs for new findings.

**2. Add two-stage context note to Core Protocol.** Insert after the existing numbered list:

```
**Note:** You are spawned as Stage 2 of a two-stage review. Stage 1 (CLI `yolo review-plan`) has
already verified structural validity (frontmatter, task count, file paths). Focus your review on
design quality, architectural risks, and adversarial analysis — not structural issues already caught.
```

**3. Update Review Checklist.** Remove structural items already covered by CLI pre-check (frontmatter completeness, task count, file paths exist). Replace with design-quality items:

New checklist:
- Architectural coherence — tasks build toward the plan's stated goal
- Risk assessment — what could go wrong during execution
- Cross-plan dependency correctness — same-wave plans don't conflict
- Must-haves are specific and verifiable (not vague)
- Implementation approach is sound (no obvious anti-patterns)
- Same-wave plans don't modify overlapping files (cross-plan reasoning)
- No obvious security anti-patterns (command injection, path traversal)
- Naming conventions followed (commit format, file naming per CONVENTIONS.md)

**4. Update Delta-Aware Review section.** Ensure the delta output format includes the new `id` field:

```
VERDICT: approve|reject|conditional
CYCLE: {N}/{max}
RESOLVED: {count}
PERSISTENT: {count}
NEW: {count}
FINDINGS:
- [id:f-001] [severity:high] [status:persistent] [file:path] issue: description | suggestion: fix
- [id:f-003] [severity:medium] [status:new] [file:path] issue: description | suggestion: fix
```

**Acceptance criteria:**
- Verdict format includes `[id:f-NNN]` on every finding line
- Delta-aware review reuses IDs for persistent findings, new IDs for new findings
- Core Protocol includes two-stage context note
- Review Checklist has 8 items focused on design quality (no structural duplicates)
- Delta-Aware Review output format includes `id` field
