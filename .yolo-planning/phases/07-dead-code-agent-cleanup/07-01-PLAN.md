---
phase: "07"
plan: "01"
title: "Remove dead code, orphaned agents, and disconnected flags"
wave: 1
depends_on: []
must_haves:
  - "agents/yolo-reviewer.md deleted"
  - "handle_stub removed from dispatcher.rs"
  - "v3_lease_locks export removed from session_start.rs"
  - "qa and scout entries removed from model-profiles.json"
---

# Plan 01: Remove Dead Code, Orphaned Agents, and Disconnected Flags

## Goal

Delete dead code paths that are unreachable from any live workflow: the yolo-reviewer agent (never wired), handle_stub (never called), v3_lease_locks export (no consumer), and qa/scout entries in model-profiles.json (agents don't exist).

## Tasks

### Task 1: Delete agents/yolo-reviewer.md

**Files:** `agents/yolo-reviewer.md`

**Why dead:** yolo-reviewer is not referenced in any command, skill, hook, or protocol file. The SubagentStart matcher in hooks.json never included it. No workflow spawns it.

**Fix:** Delete the file `agents/yolo-reviewer.md`.

**Verification:** `ls agents/` shows 5 agents: yolo-architect.md, yolo-debugger.md, yolo-dev.md, yolo-docs.md, yolo-lead.md.

### Task 2: Remove handle_stub from dispatcher.rs

**Files:** `yolo-mcp-server/src/hooks/dispatcher.rs`

**Why dead:** Lines 249-254 define `handle_stub` with `#[allow(dead_code)]`. It was a placeholder for unmigrated events â€” all events are now fully routed in `route_event()`. Never called.

**Fix:** Delete lines 249-254 (the `#[allow(dead_code)]` annotation and the entire `handle_stub` function).

**Verification:** `cargo build` succeeds. Grep for `handle_stub` returns zero matches.

### Task 3: Remove v3_lease_locks export from session_start.rs

**Files:** `yolo-mcp-server/src/commands/session_start.rs`

**Why dead:** The `v3_lease_locks` flag is read from config and exported to the cache file, but no Rust code anywhere consumes the `YOLO_V3_LEASE_LOCKS` environment variable. No lease-lock command exists.

**Fix:** Remove the `v3_lease_locks` line from the cache_content format string (~line 297) and the corresponding `get_bool("v3_lease_locks", false)` call (~line 305). Keep other v3 flags that have consumers.

**Verification:** Grep for `v3_lease_locks` in `yolo-mcp-server/src/` returns zero matches. `cargo build` succeeds.

### Task 4: Remove qa and scout entries from model-profiles.json

**Files:** `config/model-profiles.json`

**Why dead:** The `qa` and `scout` keys exist in all 3 profiles (quality, balanced, budget) but neither `yolo-qa` nor `yolo-scout` exists as an agent file. These were removed in Phase 6.

**Fix:** Delete the `"qa": "..."` and `"scout": "..."` lines from all 3 profile objects. Resulting profiles should have 5 entries each: lead, dev, debugger, architect, docs.

**Verification:** `jq keys[] config/model-profiles.json` shows only lead, dev, debugger, architect, docs per profile.
