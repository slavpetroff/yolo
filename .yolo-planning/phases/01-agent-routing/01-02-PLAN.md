---
phase: "01"
plan: "02"
title: "Add subagent_type routing to plan.md Lead spawn"
wave: 1
depends_on: []
must_haves:
  - "plan.md Lead TaskCreate includes subagent_type: yolo:yolo-lead"
  - "All existing tests pass"
---

# Plan 01-02: Add subagent_type routing to plan.md Lead spawn

## Goal

Fix the Lead agent spawn point in `skills/vibe-modes/plan.md` to include `subagent_type: "yolo:yolo-lead"` so the Lead agent is routed to the specialized agent definition with proper tool constraints and permission modes.

## Tasks

### Task 1: Add subagent_type to plan.md Lead TaskCreate

**Files:** `skills/vibe-modes/plan.md`

**Implementation:**
- In Step 6 (lines 50-51), the Lead is spawned via Task tool. The existing CRITICAL comments (line 51) mention `model` and `maxTurns` as required parameters. Add `subagent_type: "yolo:yolo-lead"` to the spawn instructions.
- Update the bullet at line 50 to explicitly include `subagent_type: "yolo:yolo-lead"` in the Task description requirements.
- Update the CRITICAL comment at line 51 to mention subagent_type:

```
- **CRITICAL:** Add `model: "${LEAD_MODEL}"`, `maxTurns: ${LEAD_MAX_TURNS}`, and `subagent_type: "yolo:yolo-lead"` parameters to the Task tool invocation.
```

- Also update line 39 (team spawn variant) to include subagent_type:
```
- Spawn Lead with `team_name: "yolo-plan-{NN}"`, `name: "lead"`, `subagent_type: "yolo:yolo-lead"` parameters on the Task tool invocation.
```

- And the non-team variant at line 49:
```
- Spawn yolo-lead as subagent via Task tool without team (single agent, no team overhead). Include `subagent_type: "yolo:yolo-lead"`.
```

**Verification:**
- `subagent_type: "yolo:yolo-lead"` appears in plan.md at all Lead spawn references
- The CRITICAL comment includes subagent_type alongside model and maxTurns

### Task 2: Verify Lead spawn and run tests

**Files:** none (verification only)

**Implementation:**
- Grep `skills/vibe-modes/plan.md` for `subagent_type` â€” expect at least 2 occurrences (team and non-team spawn paths, plus CRITICAL comment).
- Run existing bats tests to confirm no regressions.

**Verification:**
- subagent_type references found in plan.md
- All existing tests pass with 0 failures
