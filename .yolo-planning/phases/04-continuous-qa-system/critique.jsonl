{"id":"C1","cat":"risk","sev":"critical","q":"Plans 04-03 and 04-10 both write qa_gates to config/defaults.json -- which one is the source of truth and what happens if they conflict?","ctx":"04-03 T1 adds qa_gates object with 5 fields (post_task, post_plan, post_phase, timeout_seconds, failure_threshold) to config/defaults.json. 04-10 T1 also adds qa_gates object with 3 fields (post_task, post_plan, post_phase) to config/defaults.json. The schemas differ: 04-03 has 5 keys, 04-10 has 3. Both plan headers list config/defaults.json in files modified. Since 04-10 depends on 04-06/04-07/04-08 (not 04-03), a Dev working on 04-10 may overwrite the richer schema from 04-03 with a simpler one or vice versa.","sug":"Remove the config/defaults.json modification from 04-10 T1 entirely. Let 04-03 be the sole plan that defines qa_gates in defaults.json. 04-10 T1 should only modify the three gate scripts to read config toggles (the scripts part of T1), not re-add the config keys. Update 04-10 dependencies to include 04-03.","af":["04-03","04-10"],"st":"open"}
{"id":"C2","cat":"risk","sev":"critical","q":"Plan 04-05 fundamentally rewrites qa-gate.sh into a multi-level gate dispatcher, but plans 04-06 and 04-07 create separate scripts (qa-gate-post-task.sh, qa-gate-post-plan.sh, qa-gate-post-phase.sh) -- which design wins?","ctx":"04-05 T1 says 'Update scripts/qa-gate.sh to read qa_gates config... Add gate-level dispatch: accept --level post-task|post-plan|post-phase argument. Each level runs its specific checks.' Meanwhile 04-06 creates qa-gate-post-task.sh and 04-07 creates qa-gate-post-plan.sh and qa-gate-post-phase.sh. The decisions.jsonl D3 explicitly chose 'Separate scripts rather than single multi-mode script.' This directly contradicts 04-05's approach.","sug":"Reconcile: remove T2 and T3 from 04-05 (which duplicate 04-06/04-07 gate logic). 04-05 should only update qa-gate.sh for config reading (T1 partial) and config.md updates (T4). The separate scripts from 04-06/04-07 are the canonical gate implementation per decisions.jsonl D3.","af":["04-05","04-06","04-07"],"st":"open"}
{"id":"C3","cat":"gap","sev":"major","q":"Where are post-task gate results stored? No plan defines the file path or accumulation strategy.","ctx":"04-06 qa-gate-post-task.sh produces JSON output on stdout. 04-08 wires it into execute-protocol.md Step 7 after each task. But no plan specifies where results persist to disk. QA agents in 04-09 are told to read 'prior post-task gate JSONs' but no plan creates these files. Without a defined storage path, gate results evaporate after script exit.","sug":"Add result storage path and accumulation strategy. Recommended: {phase-dir}/qa-gate-results.jsonl (append-mode, one JSONL line per gate invocation). Update 04-09 to reference this specific file path.","af":["04-06","04-08","04-09"],"st":"open"}
{"id":"C4","cat":"risk","sev":"major","q":"Post-task QA gate running full test suite after every task is extremely slow -- no scoping strategy is enforced in protocol.","ctx":"04-06 T1 runs test-summary.sh (ALL tests). T2 adds optional --scope flag. But 04-08 T1 (protocol integration) does not specify whether --scope is used. Current suite: 1919 tests across 99 files. Running all after every Dev task = 5+ full test runs per plan. In teammate mode with parallel Devs, this serializes execution.","sug":"Make --scope the default in 04-08 protocol integration. Only full suite as fallback. Add 30-60s timeout for post-task (separate from 300s post-phase timeout). Consider async gate in teammate mode.","af":["04-06","04-08"],"st":"open"}
{"id":"C5","cat":"gap","sev":"major","q":"Fail-open behavior for missing tests undermines continuous QA goal -- needs explicit scenario handling.","ctx":"04-06 T1: 'Fail-open: if bats/test-summary.sh missing, output warn and exit 0.' But REQ-07 says 'QA after each Senior-approved batch.' If no tests exist, gate always passes, providing false security. Many tasks (docs, config) may not have associated tests.","sug":"Define three explicit scenarios: (1) No test infra = warn + exit 0. (2) Infra exists but no tests match modified files = pass with 'no relevant tests' note. (3) Tests exist and some fail = fail. Add plan-level check for zero ts fields.","af":["04-06"],"st":"open"}
{"id":"C6","cat":"gap","sev":"major","q":"04-05 changes qa-gate.sh interface but cannot pass --level through Notification hook system.","ctx":"qa-gate.sh is registered in hooks/hooks.json as Notification hook with 30s timeout. hook-wrapper.sh passes stdin, no arguments. New --level flag cannot be passed through hook system. Existing tests test stdin-based behavior. 04-05 T5 new tests may break existing ones.","sug":"Keep hook-registered qa-gate.sh as-is (structural check). Use separate scripts from 04-06/04-07 for workflow-level gates. 04-05 should preserve backward compatibility of hook-registered qa-gate.sh.","af":["04-05"],"st":"open"}
{"id":"C7","cat":"risk","sev":"major","q":"Race condition: parallel Devs trigger concurrent post-task gates, corrupting shared state and test execution.","ctx":"Teammate mode: up to 5 parallel Devs. Each triggers post-task gate after task completion. Concurrent appends to shared file corrupt it. Concurrent test-summary.sh invocations interfere. git-commit-serialized.sh handles commit locking but no gate result locking exists.","sug":"Add flock-based serialization for gate execution (like git-commit-serialized.sh). Or write per-task result files ({phase-dir}/qa-gate-{plan}-{task}.json) to avoid contention. Document test-summary.sh concurrency requirements.","af":["04-06","04-08"],"st":"open"}
{"id":"C8","cat":"gap","sev":"major","q":"Plans 04-05 and 04-08 both modify execute-protocol.md with no dependency relationship.","ctx":"04-05 modifies qa-gate.sh referenced by execute-protocol.md. 04-08 directly modifies execute-protocol.md. 04-08 depends on 04-06/04-07 but NOT 04-05. If 04-08 runs before 04-05, protocol references gates without config awareness. If 04-05 runs first and changes qa-gate.sh interface, 04-08 may reference wrong interface.","sug":"Add 04-05 as dependency of 04-08 (d:[\"04-05\",\"04-06\",\"04-07\"]). Or verify no file overlap in execute-protocol.md between the two plans.","af":["04-05","04-08"],"st":"open"}
{"id":"C9","cat":"gap","sev":"major","q":"validate-config.sh created but never wired into any call site -- dead code.","ctx":"Grep returns zero results for validate-config.sh. Plan 04-03 T5 creates it from scratch. No existing code calls it. session-start.sh has no validation step. config.md command doesn't validate schema. Creating isolated script without call site = dead code.","sug":"Add task wiring validate-config.sh into session-start.sh or config.md write path. Without call site, script never runs.","af":["04-03"],"st":"open"}
{"id":"C10","cat":"risk","sev":"minor","q":"Post-plan gate duplicates must_have verification already done by QA Lead agent.","ctx":"04-07 T1 verifies tr/ar/kl from plan header. QA Lead's Goal-Backward Methodology does the same deep checks. Running both is redundant. 04-09 T1 adds gate-aware verification but doesn't specify how to avoid duplicate work.","sug":"Post-plan gate = lightweight fast checks (file existence). QA Lead = deep checks (content analysis). Document separation in 04-09.","af":["04-07","04-09"],"st":"open"}
{"id":"C11","cat":"question","sev":"minor","q":"Relationship between post-phase gate and Step 9 QA unclear -- pre-check or replacement?","ctx":"04-08 T3: 'Step 9 calls qa-gate-post-phase.sh as first action before spawning QA agents.' Post-phase gate runs test-summary.sh and checks plan completion -- same as QA Code and QA Lead. Failure triggers 'generate remediation plan' but no plan defines who creates it.","sug":"Clarify in 04-08 T4: post-phase gate = fast automated pre-check (script-only, no LLM). QA agents = deep verification (LLM-powered). Cost optimization, not replacement.","af":["04-08"],"st":"open"}
{"id":"C12","cat":"improvement","sev":"minor","q":"10 plans could be reduced to ~7 by merging UX plans and removing overlaps.","ctx":"04-01/04-02 are both UX docs producing .md files. 04-03/04-10 overlap on config. 04-05 overlaps with 04-06/04-07 on gate logic. 10 plans for 3 scripts + protocol + config + agents seems high.","sug":"Consider merging: (1) 04-01+04-02 single UX plan. (2) Remove config overlap from 04-10. (3) Remove gate logic from 04-05.","af":["04-01","04-02","04-03","04-05","04-10"],"st":"open"}
